<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light">
    <meta name="theme-color" content="#367C2B">
    <meta name="description" content="Your lawn care made simple - track, plan, and achieve the perfect green lawn">
    <title>Lawn Care Tracker - Research-Backed Programs</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white" style="background-color: #ffffff !important;">
    <style>
        body::before,
        body > *:not(#root):not(script) {
            display: none !important;
        }
        #root {
            min-height: 100vh;
        }
        @keyframes slideUpBounce {
            0% { transform: translateY(100%); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        @keyframes pulseGlow {
            0%, 100% { box-shadow: 0 4px 14px rgba(255, 222, 0, 0.4); }
            50% { box-shadow: 0 4px 24px rgba(255, 222, 0, 0.7); }
        }
        @keyframes fadeSlideIn {
            0% { opacity: 0; transform: translateY(8px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        @keyframes scaleIn {
            0% { transform: scale(0.95); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .animate-fade-in { animation: fadeSlideIn 0.3s ease-out; }
        .animate-scale-in { animation: scaleIn 0.25s ease-out; }
        .card-hover { transition: transform 0.15s ease, box-shadow 0.15s ease; }
        .card-hover:active { transform: scale(0.98); }
        .btn-press { transition: transform 0.1s ease, opacity 0.1s ease; }
        .btn-press:active { transform: scale(0.95); opacity: 0.9; }
        .nav-item { transition: background-color 0.2s ease, color 0.2s ease; }
        .menu-slide { animation: fadeSlideIn 0.2s ease-out; }
        .cite-btn {
            display: inline-flex; align-items: center; justify-content: center;
            width: 18px; height: 18px; border-radius: 50%; font-size: 10px; font-weight: 700;
            color: #367C2B; background: #e8f5e9; border: 1px solid #367C2B; cursor: pointer;
            line-height: 1; vertical-align: middle; margin-left: 4px; flex-shrink: 0;
            transition: background 0.15s ease, transform 0.1s ease;
            position: relative; -webkit-tap-highlight-color: transparent;
        }
        .cite-btn::before {
            content: ''; position: absolute;
            top: -14px; left: -14px; right: -14px; bottom: -14px;
        }
        .cite-btn:hover, .cite-btn:active { background: #367C2B; color: white; transform: scale(1.1); }
        .cite-popup {
            position: fixed; z-index: 9999; background: white; border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.18); border: 1px solid #e0e0e0;
            padding: 12px 16px; max-width: 320px; min-width: 220px;
            animation: fadeSlideIn 0.15s ease-out;
        }
        .cite-popup a { color: #367C2B; text-decoration: underline; font-weight: 600; }
        .cite-popup a:hover { color: #2d6323; }
    </style>
    <div id="root"></div>

    <script src="grass-programs.js"></script>
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Citation tooltip component - shows source links on tap
        const CitationBadge = ({ sources, label }) => {
            const [open, setOpen] = useState(false);
            const btnRef = useRef(null);
            const popupRef = useRef(null);

            useEffect(() => {
                if (!open) return;
                const handleClose = (e) => {
                    if (popupRef.current && !popupRef.current.contains(e.target) &&
                        btnRef.current && !btnRef.current.contains(e.target)) {
                        setOpen(false);
                    }
                };
                // Delay listener registration so the opening tap/click doesn't
                // immediately trigger the close handler on mobile
                const raf = requestAnimationFrame(() => {
                    document.addEventListener('mousedown', handleClose);
                    document.addEventListener('touchstart', handleClose);
                });
                return () => {
                    cancelAnimationFrame(raf);
                    document.removeEventListener('mousedown', handleClose);
                    document.removeEventListener('touchstart', handleClose);
                };
            }, [open]);

            if (!sources || sources.length === 0) return null;

            const getPopupStyle = () => {
                if (!btnRef.current) return {};
                const rect = btnRef.current.getBoundingClientRect();
                const spaceBelow = window.innerHeight - rect.bottom;
                const spaceRight = window.innerWidth - rect.left;
                const style = {};
                if (spaceBelow > 200) {
                    style.top = rect.bottom + 6;
                } else {
                    style.bottom = window.innerHeight - rect.top + 6;
                }
                if (spaceRight > 340) {
                    style.left = Math.max(8, rect.left - 20);
                } else {
                    style.right = 8;
                }
                return style;
            };

            const toggle = (e) => {
                e.preventDefault();
                e.stopPropagation();
                setOpen(prev => !prev);
            };

            return (
                <span style={{position: 'relative', display: 'inline'}}>
                    <button
                        ref={btnRef}
                        className="cite-btn"
                        onClick={toggle}
                        onTouchEnd={toggle}
                        aria-label={`Sources for ${label || 'this claim'}`}
                    >i</button>
                    {open && ReactDOM.createPortal(
                        <div ref={popupRef} className="cite-popup" style={getPopupStyle()}>
                            <div style={{fontSize: 11, fontWeight: 700, color: '#367C2B', marginBottom: 6, textTransform: 'uppercase', letterSpacing: '0.5px'}}>
                                {label ? `Source: ${label}` : 'Sources'}
                            </div>
                            {sources.map((s, i) => (
                                <div key={i} style={{marginBottom: i < sources.length - 1 ? 8 : 0}}>
                                    {s.url ? (
                                        <a href={s.url} target="_blank" rel="noopener noreferrer" style={{fontSize: 13}}>
                                            {s.name || s.institution}
                                        </a>
                                    ) : (
                                        <span style={{fontSize: 13, fontWeight: 600, color: '#333'}}>{s.name || s.institution}</span>
                                    )}
                                    {(s.topic || s.title) && (
                                        <div style={{fontSize: 11, color: '#666', marginTop: 1}}>{s.topic || s.title}</div>
                                    )}
                                </div>
                            ))}
                        </div>,
                        document.body
                    )}
                </span>
            );
        };

        // Comprehensive Product Database - COMPLETE
        const PRODUCT_DATABASE = {
            mowers: [
                // Other option
                { id: 'm-other', name: 'Other (Specify)', brand: 'Other', mowerCategory: '', type: 'Custom', deck: '', features: '', maintenanceSchedule: { oilChange: null, note: 'Custom mower - set your own maintenance schedule' } },
                // Walk Behind - Top 25
                { id: 'wb1', name: 'Honda HRX217VKA', brand: 'Honda', mowerCategory: 'Walk Behind', type: 'Gas Self-Propelled', deck: '21"', features: 'Variable Speed, Versamow, GCV200', maintenanceSchedule: { oilChange: 50, airFilter: 50, sparkPlug: 100 } },
                { id: 'wb2', name: 'Honda HRN216VKA', brand: 'Honda', mowerCategory: 'Walk Behind', type: 'Gas Self-Propelled', deck: '21"', features: '3-in-1, Auto Choke, Twin Blade', maintenanceSchedule: { oilChange: 50, airFilter: 50, sparkPlug: 100 } },
                { id: 'wb3', name: 'Honda HRS216PKA', brand: 'Honda', mowerCategory: 'Walk Behind', type: 'Gas Push', deck: '21"', features: 'Reliable, Side Discharge', maintenanceSchedule: { oilChange: 50, airFilter: 50, sparkPlug: 100 } },
                { id: 'wb4', name: 'Toro Recycler 22" SmartStow', brand: 'Toro', mowerCategory: 'Walk Behind', type: 'Gas Self-Propelled', deck: '22"', features: 'Personal Pace, SmartStow, Briggs 150cc', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 'yearly' } },
                { id: 'wb5', name: 'Toro Super Recycler 21"', brand: 'Toro', mowerCategory: 'Walk Behind', type: 'Gas Self-Propelled', deck: '21"', features: 'Personal Pace, PoweReverse, Cast Aluminum', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 'yearly' } },
                { id: 'wb6', name: 'Toro Recycler 21" 21352', brand: 'Toro', mowerCategory: 'Walk Behind', type: 'Gas Self-Propelled', deck: '21"', features: 'Briggs EXi 150cc, All-Wheel Drive', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 'yearly' } },
                { id: 'wb7', name: 'Toro TimeMaster 30"', brand: 'Toro', mowerCategory: 'Walk Behind', type: 'Gas Self-Propelled', deck: '30"', features: 'Dual-Force Cutting, Personal Pace, Briggs 223cc', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 'yearly', bladeService: 'yearly' } },
                { id: 'wb8', name: 'EGO Power+ LM2142SP', brand: 'EGO', mowerCategory: 'Walk Behind', type: 'Battery Self-Propelled', deck: '21"', features: '56V, 7.5Ah, LED Headlights, Select Cut', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                { id: 'wb9', name: 'EGO Power+ LM2135SP', brand: 'EGO', mowerCategory: 'Walk Behind', type: 'Battery Self-Propelled', deck: '21"', features: '56V, 5.0Ah, Touch Drive, Select Cut', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                { id: 'wb10', name: 'Husqvarna LC221RH', brand: 'Husqvarna', mowerCategory: 'Walk Behind', type: 'Gas Self-Propelled', deck: '21"', features: 'Honda GCV160, Rear Wheel Drive, High Wheels', maintenanceSchedule: { oilChange: 50, airFilter: 50, sparkPlug: 100 } },
                { id: 'wb11', name: 'Husqvarna LC121P', brand: 'Husqvarna', mowerCategory: 'Walk Behind', type: 'Gas Push', deck: '21"', features: 'Briggs 163cc, 3-in-1', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 100 } },
                { id: 'wb12', name: 'Craftsman M215', brand: 'Craftsman', mowerCategory: 'Walk Behind', type: 'Gas Push', deck: '21"', features: 'Briggs & Stratton 140cc, Side Discharge', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 100 } },
                { id: 'wb13', name: 'Craftsman M230', brand: 'Craftsman', mowerCategory: 'Walk Behind', type: 'Gas Self-Propelled', deck: '21"', features: 'Briggs 163cc, Front-Wheel Drive', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 100 } },
                { id: 'wb14', name: 'Ryobi 40V RY40190', brand: 'Ryobi', mowerCategory: 'Walk Behind', type: 'Battery Push', deck: '20"', features: '40V Lithium 6Ah, Brushless Motor', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                { id: 'wb15', name: 'Ryobi 40V RY401110', brand: 'Ryobi', mowerCategory: 'Walk Behind', type: 'Battery Self-Propelled', deck: '21"', features: '40V Brushless, CrossCut Multi-Blade', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                { id: 'wb16', name: 'Greenworks 25223', brand: 'Greenworks', mowerCategory: 'Walk Behind', type: 'Corded Electric', deck: '20"', features: '12 Amp, 3-in-1', maintenanceSchedule: { oilChange: null, note: 'Electric - no oil changes needed' } },
                { id: 'wb17', name: 'Greenworks Pro 80V 21"', brand: 'Greenworks', mowerCategory: 'Walk Behind', type: 'Battery Self-Propelled', deck: '21"', features: '80V 4Ah, Brushless, Steel Deck', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                { id: 'wb18', name: 'Makita XML08Z', brand: 'Makita', mowerCategory: 'Walk Behind', type: 'Battery Self-Propelled', deck: '21"', features: '18V X2 (36V) LXT x4, Commercial Grade', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                { id: 'wb19', name: 'Troy-Bilt TB330', brand: 'Troy-Bilt', mowerCategory: 'Walk Behind', type: 'Gas Self-Propelled', deck: '21"', features: 'TriAction Cutting, Briggs 163cc, Rear-Wheel Drive', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 100 } },
                { id: 'wb20', name: 'Milwaukee M18 FUEL 21"', brand: 'Milwaukee', mowerCategory: 'Walk Behind', type: 'Battery Self-Propelled', deck: '21"', features: 'M18 FUEL, Smart Speed Control', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                { id: 'wb21', name: 'DeWalt DCMWSP244U2', brand: 'DeWalt', mowerCategory: 'Walk Behind', type: 'Battery Self-Propelled', deck: '21.5"', features: '2x 20V MAX, Rear Wheel Drive', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                { id: 'wb22', name: 'Black+Decker BEMW472BH', brand: 'Black+Decker', mowerCategory: 'Walk Behind', type: 'Corded Electric', deck: '15"', features: '10 Amp, Lightweight, 6 Height Settings', maintenanceSchedule: { oilChange: null, note: 'Electric - no oil changes needed' } },
                { id: 'wb23', name: 'Kobalt 80V 21"', brand: 'Kobalt', mowerCategory: 'Walk Behind', type: 'Battery Self-Propelled', deck: '21"', features: '80V 6Ah, Brushless, Quick-Fold Handle', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                { id: 'wb24', name: 'Snapper XD 82V', brand: 'Snapper', mowerCategory: 'Walk Behind', type: 'Battery Self-Propelled', deck: '21"', features: '82V Lithium, StepSense Auto Drive', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                { id: 'wb25', name: 'Worx WG779', brand: 'Worx', mowerCategory: 'Walk Behind', type: 'Battery Push', deck: '14"', features: '40V Power Share, Compact, Intellicut', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                // Riding Mowers - Top 25
                { id: 'rd1', name: 'John Deere S100', brand: 'John Deere', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '42"', features: '17.5 HP Briggs, Hydrostatic, Edge Cutting System', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd2', name: 'John Deere S130', brand: 'John Deere', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '42"', features: '22 HP V-Twin Briggs, Hydrostatic', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd3', name: 'John Deere S160', brand: 'John Deere', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '48"', features: '24 HP V-Twin ELS, Hydrostatic', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd4', name: 'John Deere S170', brand: 'John Deere', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '48"', features: '24 HP V-Twin, Cruise Control, Hydrostatic', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd5', name: 'John Deere X350', brand: 'John Deere', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '42"', features: '18.5 HP Kawasaki, Accel Deep Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd6', name: 'Husqvarna YTH18542', brand: 'Husqvarna', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '42"', features: '18.5 HP Briggs, Hydrostatic, Air Induction', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd7', name: 'Husqvarna YTH24V48', brand: 'Husqvarna', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '48"', features: '24 HP Briggs V-Twin, Hydrostatic', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd8', name: 'Husqvarna YTH22V46', brand: 'Husqvarna', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '46"', features: '22 HP Briggs V-Twin, Pedal-Operated', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd9', name: 'Husqvarna TS 142X', brand: 'Husqvarna', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '42"', features: 'Kawasaki V-Twin, ClearCut Fab Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd10', name: 'Cub Cadet XT1 LT42', brand: 'Cub Cadet', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '42"', features: '18 HP Kohler, Hydrostatic, TightTurn', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd11', name: 'Cub Cadet XT1 LT46', brand: 'Cub Cadet', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '46"', features: '22 HP Kohler V-Twin, Hydrostatic', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd12', name: 'Cub Cadet XT2 LX46', brand: 'Cub Cadet', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '46"', features: '23 HP Kawasaki V-Twin, Fabricated Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd13', name: 'Cub Cadet CC30', brand: 'Cub Cadet', mowerCategory: 'Riding', type: 'Rear Engine Rider', deck: '30"', features: '10.5 HP Briggs, Compact, Easy Storage', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 100 } },
                { id: 'rd14', name: 'Craftsman T110', brand: 'Craftsman', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '42"', features: '17.5 HP Briggs, Hydrostatic, Turn Tight', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 100 } },
                { id: 'rd15', name: 'Craftsman T210', brand: 'Craftsman', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '42"', features: '18 HP Briggs, Hydrostatic, Turn Tight', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 100 } },
                { id: 'rd16', name: 'Craftsman T240', brand: 'Craftsman', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '46"', features: '22 HP Briggs V-Twin, Hydrostatic', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 100 } },
                { id: 'rd17', name: 'Troy-Bilt Pony 42"', brand: 'Troy-Bilt', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '42"', features: '15.5 HP Briggs, 7-Speed Manual', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 100 } },
                { id: 'rd18', name: 'Troy-Bilt Bronco 42"', brand: 'Troy-Bilt', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '42"', features: '17 HP Briggs, Hydrostatic', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 100 } },
                { id: 'rd19', name: 'Troy-Bilt Super Bronco 46"', brand: 'Troy-Bilt', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '46"', features: '22 HP Briggs V-Twin, Hydrostatic', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 100 } },
                { id: 'rd20', name: 'Ariens Edge 34"', brand: 'Ariens', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '34"', features: '20 HP Kohler, Compact Design', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd21', name: 'Murray MT100 42"', brand: 'Murray', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '42"', features: '13.5 HP Briggs, 6-Speed Manual', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 100 } },
                { id: 'rd22', name: 'Snapper SPX 42"', brand: 'Snapper', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '42"', features: '23 HP Briggs V-Twin, Hydrostatic', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'rd23', name: 'Poulan Pro PP155H42', brand: 'Poulan Pro', mowerCategory: 'Riding', type: 'Lawn Tractor', deck: '42"', features: '15.5 HP Briggs, Hydrostatic', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 100 } },
                { id: 'rd24', name: 'Ryobi RYAC130-S', brand: 'Ryobi', mowerCategory: 'Riding', type: 'Electric Riding', deck: '30"', features: '50 Ah Battery, Brushless Motor', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                { id: 'rd25', name: 'EGO Power+ T6', brand: 'EGO', mowerCategory: 'Riding', type: 'Electric Lawn Tractor', deck: '42"', features: '56V, Peak HP, Headlights, USB Port', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                // Zero Turn - Top 25
                { id: 'zt1', name: 'John Deere Z335E', brand: 'John Deere', mowerCategory: 'Zero Turn', type: 'Residential ZTR', deck: '42"', features: '20 HP V-Twin, Accel Deep Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt2', name: 'John Deere Z370R', brand: 'John Deere', mowerCategory: 'Zero Turn', type: 'Residential ZTR', deck: '54"', features: '22 HP V-Twin, Accel Deep 42A Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt3', name: 'John Deere Z530M', brand: 'John Deere', mowerCategory: 'Zero Turn', type: 'Commercial ZTR', deck: '54"', features: '24 HP Kawasaki V-Twin, Pro-Grade', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt4', name: 'Husqvarna Z254', brand: 'Husqvarna', mowerCategory: 'Zero Turn', type: 'Residential ZTR', deck: '54"', features: '26 HP Kohler, ClearCut Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt5', name: 'Husqvarna Z248F', brand: 'Husqvarna', mowerCategory: 'Zero Turn', type: 'Residential ZTR', deck: '48"', features: '23 HP Kawasaki, Stamped Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt6', name: 'Husqvarna MZ61', brand: 'Husqvarna', mowerCategory: 'Zero Turn', type: 'Commercial ZTR', deck: '61"', features: '27 HP Briggs, Fabricated Deck, ROPS', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt7', name: 'Husqvarna Z454', brand: 'Husqvarna', mowerCategory: 'Zero Turn', type: 'Commercial ZTR', deck: '54"', features: '23 HP Kawasaki, ClearCut Fab Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt8', name: 'Toro TimeCutter 42"', brand: 'Toro', mowerCategory: 'Zero Turn', type: 'Residential ZTR', deck: '42"', features: '22.5 HP Toro V-Twin, MyRIDE, Smart Speed', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 'yearly' } },
                { id: 'zt9', name: 'Toro Titan 60"', brand: 'Toro', mowerCategory: 'Zero Turn', type: 'Commercial ZTR', deck: '60"', features: '24.5 HP Toro V-Twin, IronForged Deck, MyRIDE', maintenanceSchedule: { oilChange: 50, airFilter: 'yearly', sparkPlug: 'yearly' } },
                { id: 'zt10', name: 'Cub Cadet Ultima ZT1 42"', brand: 'Cub Cadet', mowerCategory: 'Zero Turn', type: 'Residential ZTR', deck: '42"', features: '22 HP Kohler V-Twin, High-Back Seat', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt11', name: 'Cub Cadet Ultima ZT1 50"', brand: 'Cub Cadet', mowerCategory: 'Zero Turn', type: 'Residential ZTR', deck: '50"', features: '23 HP Kawasaki V-Twin, AeroForce Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt12', name: 'Cub Cadet Ultima ZT2 54"', brand: 'Cub Cadet', mowerCategory: 'Zero Turn', type: 'Commercial ZTR', deck: '54"', features: '24 HP Kawasaki V-Twin, Fabricated Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt13', name: 'Ariens IKON XD 42"', brand: 'Ariens', mowerCategory: 'Zero Turn', type: 'Residential ZTR', deck: '42"', features: '22 HP Kohler, Fabricated Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt14', name: 'Ariens IKON XD 52"', brand: 'Ariens', mowerCategory: 'Zero Turn', type: 'Residential ZTR', deck: '52"', features: '23 HP Kawasaki, Fabricated Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt15', name: 'Ariens Apex 52"', brand: 'Ariens', mowerCategory: 'Zero Turn', type: 'Commercial ZTR', deck: '52"', features: '23 HP Kawasaki, Heavy-Duty Fabricated', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt16', name: 'EGO Z6 42"', brand: 'EGO', mowerCategory: 'Zero Turn', type: 'Battery ZTR', deck: '42"', features: '56V, e-Steer, Brushless Motors', maintenanceSchedule: { oilChange: null, note: 'Battery-powered - no oil changes needed' } },
                { id: 'zt17', name: 'Bad Boy MZ 42"', brand: 'Bad Boy', mowerCategory: 'Zero Turn', type: 'Residential ZTR', deck: '42"', features: '22 HP Kohler, Welded Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt18', name: 'Bad Boy MZ Magnum 54"', brand: 'Bad Boy', mowerCategory: 'Zero Turn', type: 'Commercial ZTR', deck: '54"', features: '27 HP Kohler, Fabricated Deck, ROPS', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt19', name: 'Gravely ZT HD 44"', brand: 'Gravely', mowerCategory: 'Zero Turn', type: 'Residential ZTR', deck: '44"', features: '22 HP Kawasaki, Fabricated Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt20', name: 'Gravely ZT X 42"', brand: 'Gravely', mowerCategory: 'Zero Turn', type: 'Residential ZTR', deck: '42"', features: '21.5 HP Kawasaki, Fabricated Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt21', name: 'Spartan RZ-C 42"', brand: 'Spartan', mowerCategory: 'Zero Turn', type: 'Residential ZTR', deck: '42"', features: '22 HP Briggs, Welded Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt22', name: 'Spartan RZ Pro 54"', brand: 'Spartan', mowerCategory: 'Zero Turn', type: 'Commercial ZTR', deck: '54"', features: '25 HP Briggs, Fabricated Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt23', name: 'Ferris IS 600Z', brand: 'Ferris', mowerCategory: 'Zero Turn', type: 'Commercial ZTR', deck: '48"', features: '25 HP Briggs, iCD Cutting System', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt24', name: 'Exmark Radius S-Series 42"', brand: 'Exmark', mowerCategory: 'Zero Turn', type: 'Commercial ZTR', deck: '42"', features: '22 HP Kohler, UltraCut Series 3', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } },
                { id: 'zt25', name: 'Scag Liberty Z 48"', brand: 'Scag', mowerCategory: 'Zero Turn', type: 'Commercial ZTR', deck: '48"', features: '22 HP Kohler, Cutter Deck', maintenanceSchedule: { oilChange: 50, airFilter: 100, sparkPlug: 100 } }
            ],
            spreaders: [
                { id: 'sp1', name: 'Echo RB-60 Spreader', brand: 'Echo', type: 'Broadcast', capacity: '60 lbs', features: 'Edge Guard, Pneumatic Tires', maintenanceSchedule: { cleaning: 'after each use', tires: 'check pressure 15 psi', note: 'Maintenance-free gear case' } },
                { id: 'sp2', name: 'Scotts Elite Spreader', brand: 'Scotts', type: 'Broadcast', capacity: '20000 sq ft', features: 'EdgeGuard, Never Flat Tires', maintenanceSchedule: { cleaning: 'after each use', note: 'No lubrication required' } },
                { id: 'sp3', name: 'Earthway 2150', brand: 'Earthway', type: 'Broadcast', capacity: '50 lbs', features: 'Commercial Grade, EV-N-Spred', maintenanceSchedule: { cleaning: 'after each use', lubrication: 'seasonal' } },
                { id: 'sp4', name: 'Agri-Fab 45-0463', brand: 'Agri-Fab', type: 'Tow-Behind', capacity: '130 lbs', features: 'Universal Hitch, Pneumatic Tires', maintenanceSchedule: { cleaning: 'after each use', lubrication: 'seasonal', tires: 'check pressure' } },
                { id: 'sp5', name: 'Chapin 8706A', brand: 'Chapin', type: 'Broadcast', capacity: '80 lbs', features: 'Auto-Stop, Baffle System', maintenanceSchedule: { cleaning: 'after each use', lubrication: 'before each season' } },
                { id: 'sp6', name: 'Scotts Wizz Hand-Held', brand: 'Scotts', type: 'Hand-Held', capacity: '2500 sq ft', features: 'Battery Powered, EdgeGuard', maintenanceSchedule: { cleaning: 'after each use', battery: 'charge as needed' } },
                { id: 'sp7', name: 'Lesco High Wheel', brand: 'Lesco', type: 'Broadcast', capacity: '80 lbs', features: 'Stainless Steel, Pro-Grade', maintenanceSchedule: { cleaning: 'after each use', lubrication: 'monthly during season' } },
                { id: 'sp8', name: 'Spyker P70-12010', brand: 'Spyker', type: 'Broadcast', capacity: '70 lbs', features: 'Enclosed Gears, Pro Series', maintenanceSchedule: { cleaning: 'after each use', gearbox: 'check oil annually' } },
                { id: 'sp9', name: 'Brinly BS36BH', brand: 'Brinly', type: 'Tow-Behind', capacity: '175 lbs', features: 'Pneumatic Tires, Heavy Duty', maintenanceSchedule: { cleaning: 'after each use', lubrication: 'seasonal', tires: 'check pressure' } },
                { id: 'sp10', name: 'Scotts Turf Builder EdgeGuard Mini', brand: 'Scotts', type: 'Broadcast', capacity: '5000 sq ft', features: 'Compact, EdgeGuard', maintenanceSchedule: { cleaning: 'after each use', note: 'Minimal maintenance' } }
            ],
            trimmers: [
                { id: 't-other', name: 'Other (Specify)', brand: 'Other', type: 'Custom', engineType: '', lineSize: '' },
                { id: 't1', name: 'Echo SRM-225', brand: 'Echo', type: 'Gas', engineType: 'Gas', lineSize: '.095"', features: '21.2cc, 2-Stroke' },
                { id: 't2', name: 'Stihl FS 56 RC-E', brand: 'Stihl', type: 'Gas', engineType: 'Gas', lineSize: '.105"', features: '27.2cc, Easy2Start' },
                { id: 't3', name: 'Husqvarna 128LD', brand: 'Husqvarna', type: 'Gas', engineType: 'Gas', lineSize: '.095"', features: '28cc, Detachable' },
                { id: 't4', name: 'EGO Power+ ST1521S', brand: 'EGO', type: 'Battery', engineType: 'Electric', lineSize: '.095"', features: '56V, Powerload' },
                { id: 't5', name: 'Makita XRU15Z', brand: 'Makita', type: 'Battery', engineType: 'Electric', lineSize: '.095"', features: '18V LXT' },
                { id: 't6', name: 'DeWalt DCST972X1', brand: 'DeWalt', type: 'Battery', engineType: 'Electric', lineSize: '.080"', features: '60V Max Flex' },
                { id: 't7', name: 'Ryobi RY40250', brand: 'Ryobi', type: 'Battery', engineType: 'Electric', lineSize: '.080"', features: '40V Brushless' },
                { id: 't8', name: 'Black+Decker LST136', brand: 'Black+Decker', type: 'Battery', engineType: 'Electric', lineSize: '.065"', features: '40V, Auto-Feed' },
                { id: 't9', name: 'Milwaukee 2825-21ST', brand: 'Milwaukee', type: 'Battery', engineType: 'Electric', lineSize: '.080"', features: 'M18 Fuel Quik-Lok' },
                { id: 't10', name: 'Craftsman CMXGTAMD25CC', brand: 'Craftsman', type: 'Gas', engineType: 'Gas', lineSize: '.095"', features: '25cc, 2-Cycle' }
            ],
            fertilizers: [
                { id: 'f1', name: 'Scotts Turf Builder Lawn Food', brand: 'Scotts', npk: '32-0-4', coverage: '15000 sq ft', type: 'Slow-Release Nitrogen' },
                { id: 'f2', name: 'Milorganite Organic Fertilizer', brand: 'Milorganite', npk: '6-4-0', coverage: '2500 sq ft', type: 'Organic, Slow-Release' },
                { id: 'f3', name: 'Jonathan Green Green-Up', brand: 'Jonathan Green', npk: '29-0-3', coverage: '15000 sq ft', type: 'Professional Grade' },
                { id: 'f4', name: 'Pennington UltraGreen', brand: 'Pennington', npk: '30-0-4', coverage: '12500 sq ft', type: 'Nitrogen Stabilized' },
                { id: 'f5', name: 'GreenView Fairway Formula', brand: 'GreenView', npk: '22-0-4', coverage: '15000 sq ft', type: 'Spring Booster' },
                { id: 'f6', name: 'Lesco Professional 24-0-11', brand: 'Lesco', npk: '24-0-11', coverage: '12500 sq ft', type: 'Balanced Formula' },
                { id: 'f7', name: 'Scotts Turf Builder EdgeGuard', brand: 'Scotts', npk: '38-0-6', coverage: '10000 sq ft', type: 'High Nitrogen' },
                { id: 'f8', name: 'Safer Brand Lawn Restore', brand: 'Safer Brand', npk: '9-0-2', coverage: '5000 sq ft', type: 'Organic, Pet-Safe' },
                { id: 'f9', name: 'Purely Organic Lawn Food', brand: 'Purely Organic', npk: '10-0-2', coverage: '2000 sq ft', type: 'OMRI Certified' },
                { id: 'f10', name: 'Sunday Smart Lawn Care', brand: 'Sunday', npk: '11-0-0', coverage: '5000 sq ft', type: 'Custom Blend, Organic' }
            ],
            seeds: [
                { id: 's1', name: 'Scotts Turf Builder Grass Seed', brand: 'Scotts', type: 'Sun & Shade Mix', coverage: '2800 sq ft', variety: 'Tall Fescue Blend' },
                { id: 's2', name: 'Pennington Smart Seed', brand: 'Pennington', type: 'Dense Shade', coverage: '1200 sq ft', variety: 'Fine Fescue Mix' },
                { id: 's3', name: 'Jonathan Green Black Beauty', brand: 'Jonathan Green', type: 'Ultra Mix', coverage: '5600 sq ft', variety: 'Tall Fescue' },
                { id: 's4', name: 'GCI Turf Type Tall Fescue', brand: 'GCI', type: 'Premium TTTF', coverage: '10000 sq ft', variety: 'Certified Seed' },
                { id: 's5', name: 'Kentucky 31 Tall Fescue', brand: 'Pennington', type: 'K-31', coverage: '5000 sq ft', variety: 'Cool Season' },
                { id: 's6', name: 'Perennial Ryegrass Seed', brand: 'Barenbrug', type: 'RPR Technology', coverage: '5000 sq ft', variety: 'Quick Germination' },
                { id: 's7', name: 'Scotts EZ Seed Patch & Repair', brand: 'Scotts', type: 'Mulch Mix', coverage: '225 sq ft', variety: 'All-in-One' },
                { id: 's8', name: 'Zoysia Grass Seed', brand: 'Zenith', type: 'Warm Season', coverage: '2000 sq ft', variety: 'Drought Tolerant' },
                { id: 's9', name: 'Bermuda Grass Seed', brand: 'Outsidepride', type: 'Improved', coverage: '3000 sq ft', variety: 'Southern Lawns' },
                { id: 's10', name: 'Kentucky Bluegrass Mix', brand: 'Jonathan Green', type: 'Premium KBG', coverage: '3000 sq ft', variety: 'Fine Texture' }
            ]
        };
        
        // Treatment Products Database - COMPLETE
        const TREATMENT_PRODUCTS = {
            fertilizer: [
                { id: 'f1', name: 'Scotts Turf Builder Lawn Food', brand: 'Scotts', activeIngredient: '32-0-4', rate: 'Per label', timing: 'Spring/Fall', notes: 'Slow-Release Nitrogen' },
                { id: 'f2', name: 'Milorganite Organic Fertilizer', brand: 'Milorganite', activeIngredient: '6-4-0', rate: 'Per label', timing: 'Any season', notes: 'Organic, Slow-Release' },
                { id: 'f3', name: 'Jonathan Green Green-Up', brand: 'Jonathan Green', activeIngredient: '29-0-3', rate: 'Per label', timing: 'Spring/Fall', notes: 'Professional Grade' },
                { id: 'f4', name: 'Pennington UltraGreen', brand: 'Pennington', activeIngredient: '30-0-4', rate: 'Per label', timing: 'Growing season', notes: 'Nitrogen Stabilized' },
                { id: 'f5', name: 'Other (specify)', brand: 'Various', activeIngredient: '', rate: 'See label', timing: '', notes: 'Custom product' }
            ],
            preemergent: [
                { id: 'pre1', name: 'Prodiamine 65 WDG (Yard Mastery)', brand: 'Yard Mastery', activeIngredient: 'Prodiamine 65%', rate: '0.5 oz per 1,000 sq ft', timing: 'When soil hits 50-55¬∞F', notes: 'Premium WDG formulation' },
                { id: 'pre2', name: 'Barricade 4FL', brand: 'Syngenta', activeIngredient: 'Prodiamine 41.7%', rate: '0.5 fl oz per 1,000 sq ft', timing: 'Early spring & fall', notes: 'Liquid concentrate' },
                { id: 'pre3', name: 'Dimension 2EW', brand: 'Dow', activeIngredient: 'Dithiopyr 23.3%', rate: '0.5 fl oz per 1,000 sq ft', timing: 'Pre & early post-emergent', notes: 'Works on young crabgrass' },
                { id: 'pre4', name: 'Scotts Halts', brand: 'Scotts', activeIngredient: 'Pendimethalin', rate: '2.9 lbs per 1,000 sq ft', timing: 'Early spring', notes: 'Granular, easy application' },
                { id: 'pre5', name: 'Other (specify)', brand: 'Various', activeIngredient: '', rate: 'See label', timing: '', notes: 'Custom product' }
            ],
            postemergent: [
                { id: 'post1', name: 'Tenacity', brand: 'Syngenta', activeIngredient: 'Mesotrione 40%', rate: '0.25 oz per 1,000 sq ft', target: 'Crabgrass, broadleaf weeds', notes: 'Safe for seeding' },
                { id: 'post2', name: 'Ortho Weed B Gon', brand: 'Ortho', activeIngredient: '2,4-D + Quinclorac', rate: 'Per label', target: 'Broadleaf & grassy weeds', notes: 'Ready-to-spray' },
                { id: 'post3', name: 'Speedzone', brand: 'PBI Gordon', activeIngredient: '2,4-D + others', rate: '1.5 fl oz per 1,000 sq ft', target: 'Fast-acting broadleaf', notes: 'Works in cool temps' },
                { id: 'post4', name: 'Quinclorac 75DF', brand: 'Various', activeIngredient: 'Quinclorac 75%', rate: '0.25 oz per 1,000 sq ft', target: 'Crabgrass, clover', notes: 'Selective herbicide' },
                { id: 'post5', name: 'Other (specify)', brand: 'Various', activeIngredient: '', rate: 'See label', target: '', notes: 'Custom product' }
            ],
            fungicide: [
                { id: 'fung1', name: 'Disease Ex (Scotts)', brand: 'Scotts', activeIngredient: 'Azoxystrobin 0.31%', rate: '3 lbs per 1,000 sq ft', target: 'Brown patch, dollar spot', notes: 'Granular, preventative' },
                { id: 'fung2', name: 'Azoxystrobin 0.31G', brand: 'Various', activeIngredient: 'Azoxystrobin 0.31%', rate: '3 lbs per 1,000 sq ft', target: 'Broad spectrum', notes: 'Generic Disease Ex' },
                { id: 'fung3', name: 'Propiconazole 14.3', brand: 'Various', activeIngredient: 'Propiconazole 14.3%', rate: '1 fl oz per 1,000 sq ft', target: 'Systemic fungicide', notes: 'Liquid concentrate' },
                { id: 'fung4', name: 'Heritage G', brand: 'Syngenta', activeIngredient: 'Azoxystrobin 0.5%', rate: '2 lbs per 1,000 sq ft', target: 'Premium fungicide', notes: 'Professional grade' },
                { id: 'fung5', name: 'Other (specify)', brand: 'Various', activeIngredient: '', rate: 'See label', target: '', notes: 'Custom product' }
            ],
            insecticide: [
                { id: 'ins1', name: 'GrubEx (Scotts)', brand: 'Scotts', activeIngredient: 'Chlorantraniliprole', rate: '2.87 lbs per 1,000 sq ft', target: 'Grubs (preventative)', notes: 'Apply late spring/early summer' },
                { id: 'ins2', name: 'BioAdvanced Grub Killer', brand: 'BioAdvanced', activeIngredient: 'Imidacloprid', rate: '3 lbs per 1,000 sq ft', target: 'Grubs, mole crickets', notes: 'Season-long control' },
                { id: 'ins3', name: 'Dylox 6.2G', brand: 'Bayer', activeIngredient: 'Trichlorfon 6.2%', rate: '3 lbs per 1,000 sq ft', target: 'Active grubs', notes: '24-hour curative' },
                { id: 'ins4', name: 'Bifenthrin 0.2G', brand: 'Various', activeIngredient: 'Bifenthrin 0.2%', rate: '2.3 lbs per 1,000 sq ft', target: 'Surface insects', notes: 'Ants, chinch bugs' },
                { id: 'ins5', name: 'Other (specify)', brand: 'Various', activeIngredient: '', rate: 'See label', target: '', notes: 'Custom product' }
            ],
            soilAmendment: [
                { id: 'soil1', name: 'Pelletized Lime', brand: 'Various', type: 'pH Increase', rate: '50 lbs per 1,000 sq ft', effect: 'Raises pH by ~0.5', notes: 'For acidic soils (pH <6.5)' },
                { id: 'soil2', name: 'Elemental Sulfur', brand: 'Various', type: 'pH Decrease', rate: '5-10 lbs per 1,000 sq ft', effect: 'Lowers pH by ~0.5', notes: 'For alkaline soils (pH >7.0)' },
                { id: 'soil3', name: 'Gypsum', brand: 'Various', type: 'Soil Structure', rate: '40 lbs per 1,000 sq ft', effect: 'Improves clay soil', notes: 'Does not change pH' },
                { id: 'soil4', name: 'Humic Acid', brand: 'Various', type: 'Soil Health', rate: '3 fl oz per 1,000 sq ft', effect: 'Improves nutrient uptake', notes: 'Liquid application' },
                { id: 'soil5', name: 'Other (specify)', brand: 'Various', type: '', rate: 'See label', effect: '', notes: 'Custom product' }
            ]
        };
        
        const TREATMENT_CATEGORIES = {
            fertilizer: { label: 'Fertilizer', icon: 'üåæ', description: 'NPK nutrients for growth' },
            preemergent: { label: 'Pre-Emergent', icon: 'üõ°Ô∏è', description: 'Prevent weed seeds' },
            postemergent: { label: 'Post-Emergent', icon: 'üåø', description: 'Kill existing weeds' },
            fungicide: { label: 'Fungicide', icon: 'üçÑ', description: 'Prevent/treat diseases' },
            insecticide: { label: 'Insecticide', icon: 'üêõ', description: 'Control grubs/insects' },
            soilAmendment: { label: 'Soil Amendment', icon: 'üåç', description: 'Adjust pH/improve soil' }
        };
        
        const ACTIVITY_TYPES = {
            mowing: {
                name: 'Mowing Lawn',
                icon: 'üå±',
                color: 'bg-[#367C2B]',
                fields: [
                    { name: 'mowerType', label: 'Mower Type', type: 'select', options: ['Walk Behind', 'Riding', 'Zero Turn'] },
                    { name: 'mowerUsed', label: 'Mower Model', type: 'product-select', productType: 'mowers', filterBy: 'mowerType', filterProp: 'mowerCategory' },
                    { name: 'mowHeight', label: 'Mow Height', type: 'select', options: ['1.5"', '2"', '2.5"', '3"', '3.5"', '4"'] },
                    { name: 'clippings', label: 'Clippings', type: 'select', options: ['Bagging', 'Mulching', 'Side Discharge'] },
                    { name: 'duration', label: 'Duration (minutes)', type: 'number', placeholder: '45' }
                ]
            },
            fertilizer: {
                name: 'Fertilizer & Treatments',
                icon: 'üåæ',
                color: 'bg-[#367C2B]',
                fields: [
                    { name: 'category', label: 'Treatment Category', type: 'treatment-category', required: true },
                    { name: 'product', label: 'Product', type: 'treatment-product', required: true },
                    { name: 'spreader', label: 'Spreader (Optional)', type: 'product-select', productType: 'spreaders' },
                    { name: 'spreaderSetting', label: 'Spreader Setting', type: 'text', placeholder: 'e.g., 3.5, D, or 14' },
                    { name: 'applicationRate', label: 'Application Rate', type: 'text', placeholder: '0.5 oz per 1,000 sq ft' },
                    { name: 'coverage', label: 'Coverage (sq ft)', type: 'number', placeholder: '5000' }
                ]
            },
            trimming: {
                name: 'Trimming Beds',
                icon: '‚úÇÔ∏è',
                color: 'bg-[#367C2B]',
                fields: [
                    { name: 'areas', label: 'Areas Trimmed', type: 'text' },
                    { name: 'toolUsed', label: 'Tool Used', type: 'select', options: ['String Trimmer', 'Edger', 'Hedge Trimmer'] }
                ]
            },
            watering: {
                name: 'Watering',
                icon: 'üíß',
                color: 'bg-[#367C2B]',
                fields: [
                    { name: 'method', label: 'Method', type: 'select', options: ['Sprinkler System', 'Hose', 'Hand Watering'] },
                    { name: 'duration', label: 'Duration (minutes)', type: 'number' }
                ]
            },
            seeding: {
                name: 'Seeding/Overseeding',
                icon: 'üå±',
                color: 'bg-[#367C2B]',
                fields: [
                    { name: 'product', label: 'Grass Seed', type: 'product-select', productType: 'seeds' },
                    { name: 'spreader', label: 'Spreader (Optional)', type: 'product-select', productType: 'spreaders' },
                    { name: 'spreaderSetting', label: 'Spreader Setting', type: 'text', placeholder: 'e.g., 3.5, D, or 14' },
                    { name: 'amountUsed', label: 'Amount Used (lbs)', type: 'number' }
                ]
            },
            aeration: {
                name: 'Aeration',
                icon: 'üîß',
                color: 'bg-[#367C2B]',
                fields: [
                    { name: 'method', label: 'Method', type: 'select', options: ['Core Aeration', 'Spike Aeration', 'Liquid Aeration'] },
                    { name: 'coverage', label: 'Coverage (sq ft)', type: 'number' }
                ]
            },
            maintenance: {
                name: 'Equipment Maintenance',
                icon: 'üîß',
                color: 'bg-[#367C2B]',
                fields: [
                    { name: 'equipmentType', label: 'Equipment', type: 'select', options: ['Mower', 'Trimmer', 'Edger', 'Blower', 'Other'] },
                    { name: 'maintenanceType', label: 'Maintenance', type: 'select', options: ['Oil Change', 'Blade Sharpening', 'Spark Plug', 'Air Filter', 'Cleaning'] }
                ]
            }
        };

        const ACTIVITY_COLORS = {
            mowing: { bg: 'bg-[#367C2B]/10', border: 'border-[#367C2B]', text: 'text-[#367C2B]', hex: '#367C2B' },
            fertilizer: { bg: 'bg-orange-50', border: 'border-[#F97316]', text: 'text-[#F97316]', hex: '#F97316' },
            trimming: { bg: 'bg-emerald-50', border: 'border-emerald-500', text: 'text-emerald-600', hex: '#10B981' },
            watering: { bg: 'bg-blue-50', border: 'border-[#3B82F6]', text: 'text-[#3B82F6]', hex: '#3B82F6' },
            seeding: { bg: 'bg-amber-50', border: 'border-[#92400E]', text: 'text-[#92400E]', hex: '#92400E' },
            aeration: { bg: 'bg-purple-50', border: 'border-purple-500', text: 'text-purple-600', hex: '#8B5CF6' },
            maintenance: { bg: 'bg-gray-50', border: 'border-[#6B7280]', text: 'text-[#6B7280]', hex: '#6B7280' }
        };

        // COMPLETE Research Sources - All 19 Universities
        const RESEARCH_SOURCES = [
            { id: 'psu', name: 'Penn State Extension', count: 8, url: 'https://extension.psu.edu/', topics: 'Tall Fescue, Kentucky Bluegrass, Cool-Season Care, Fertilization, Mowing Heights' },
            { id: 'purdue', name: 'Purdue Extension', count: 6, url: 'https://www.purdue.edu/hla/sites/turf/', topics: 'Cool-Season Grasses, Lawn Establishment, Disease Management' },
            { id: 'ncstate', name: 'NC State Extension', count: 12, url: 'https://content.ces.ncsu.edu/', topics: 'Transition Zone Management, Tall Fescue Heat Tolerance, Bermudagrass, Zoysiagrass, Centipedegrass' },
            { id: 'uga', name: 'University of Georgia Extension', count: 10, url: 'https://extension.uga.edu/', topics: 'Warm-Season Grasses, Bermudagrass Varieties, St. Augustine Care, Disease Control' },
            { id: 'tamu', name: 'Texas A&M AgriLife Extension', count: 9, url: 'https://agrilifeextension.tamu.edu/', topics: 'Bermudagrass, St. Augustine, Zoysiagrass, Heat Management, Drought Tolerance' },
            { id: 'msu', name: 'Michigan State Extension', count: 5, url: 'https://www.canr.msu.edu/turf/', topics: 'Cool-Season Grasses, Northern Climate Management, Kentucky Bluegrass' },
            { id: 'clemson', name: 'Clemson Extension', count: 7, url: 'https://www.clemson.edu/extension/', topics: 'Transition Zone, Centipedegrass, Tall Fescue in Heat, Bermudagrass Spring Dead Spot' },
            { id: 'vt', name: 'Virginia Tech Extension', count: 6, url: 'https://ext.vt.edu/', topics: 'Transition Zone Grasses, Tall Fescue Varieties, Bermudagrass Cold Hardiness' },
            { id: 'ufl', name: 'University of Florida IFAS', count: 8, url: 'https://sfyl.ifas.ufl.edu/', topics: 'St. Augustine, Bahiagrass, Centipedegrass, Year-Round Management' },
            { id: 'kstate', name: 'Kansas State Extension', count: 5, url: 'https://www.bookstore.ksre.ksu.edu/', topics: 'Bermudagrass Cold Tolerance, Transition Zone, Zoysiagrass' },
            { id: 'umn', name: 'University of Minnesota Extension', count: 4, url: 'https://extension.umn.edu/', topics: 'Kentucky Bluegrass, Cool-Season Grasses, Zone 4 Management' },
            { id: 'lsu', name: 'LSU AgCenter', count: 6, url: 'https://www.lsuagcenter.com/', topics: 'Warm-Season Grasses, Centipedegrass, St. Augustine, High Humidity Management' },
            { id: 'osu', name: 'Ohio State Extension', count: 5, url: 'https://ohioline.osu.edu/', topics: 'Cool-Season Grasses, Tall Fescue, Kentucky Bluegrass, Midwest Climate' },
            { id: 'rutgers', name: 'Rutgers Cooperative Extension', count: 4, url: 'https://njaes.rutgers.edu/', topics: 'Cool-Season Turf, Disease Management, Fine Fescues' },
            { id: 'uark', name: 'University of Arkansas Extension', count: 4, url: 'https://www.uaex.uada.edu/', topics: 'Transition Zone, Bermudagrass, Zoysiagrass, Tall Fescue' },
            { id: 'uconn', name: 'UConn Extension', count: 3, url: 'https://extension.uconn.edu/', topics: 'Cool-Season Grasses, Fine Fescues, Northeast Climate' },
            { id: 'aces', name: 'Alabama Cooperative Extension', count: 5, url: 'https://www.aces.edu/', topics: 'Warm-Season Grasses, Bermudagrass, Centipedegrass, Southeast Climate' },
            { id: 'okstate', name: 'Oklahoma State Extension', count: 4, url: 'https://extension.okstate.edu/', topics: 'Bermudagrass, Transition Zone, Drought Management' },
            { id: 'umass', name: 'UMass Extension', count: 3, url: 'https://ag.umass.edu/turf', topics: 'Cool-Season Grasses, Sports Turf, Northern Management' }
        ];

        // Grass type reference data - research-backed from university extensions
        const GRASS_INFO = {
            'tall-fescue': {
                name: 'Tall Fescue',
                season: 'Cool Season',
                mowHeight: '3 - 4 inches',
                mowHeightSummer: '3.5 - 4 inches',
                waterPerWeek: '1 - 1.5 inches',
                idealSoilPH: '5.8 - 6.5',
                idealSoilTemp: '50 - 65¬∞F for growth',
                sunNeeds: 'Full sun to partial shade (4-6 hrs)',
                fertPerYear: '3 - 4 lbs N per 1,000 sq ft',
                peakGrowth: 'Spring & Fall',
                dormancy: 'May slow/brown in summer heat',
                bestFeature: 'Deep root system, excellent drought tolerance for a cool-season grass',
                commonIssues: ['Brown patch in humid summers', 'Pythium blight in wet conditions', 'Can thin in heavy shade'],
                keyTips: [
                    'September is the #1 most important month - fertilize heavily and overseed',
                    'Raise mowing height in summer to reduce heat stress',
                    'Never remove more than 1/3 of the blade at a time',
                    'Core aerate in fall for best results'
                ],
                zoneNotes: {
                    '4': 'Excellent choice - very cold hardy. Focus on spring/fall feeding.',
                    '5': 'Ideal zone. Standard cool-season program works perfectly.',
                    '6': 'Great performance. Watch for brown patch in humid summers.',
                    '7': 'Transition zone - use heat-tolerant varieties (Firecracker LS, Mustang 4). Summer stress is real.',
                    '8': 'Challenging - will struggle in summer. Consider warm-season alternatives.',
                    '9': 'Not recommended - too hot. Switch to bermuda, zoysia, or st. augustine.'
                },
                sources: [
                    { name: 'Penn State Extension', url: 'https://extension.psu.edu/lawn-care', topic: 'Tall Fescue Lawn Maintenance Calendar' },
                    { name: 'Purdue Extension', url: 'https://www.purdue.edu/hla/sites/turf/tall-fescue/', topic: 'Tall Fescue Management' },
                    { name: 'NC State Extension', url: 'https://content.ces.ncsu.edu/carolina-lawns', topic: 'Carolina Lawns: Tall Fescue' }
                ]
            },
            'kentucky-bluegrass': {
                name: 'Kentucky Bluegrass',
                season: 'Cool Season',
                mowHeight: '2.5 - 3.5 inches',
                mowHeightSummer: '3 - 3.5 inches',
                waterPerWeek: '1 - 1.5 inches',
                idealSoilPH: '6.0 - 7.0',
                idealSoilTemp: '50 - 65¬∞F for growth',
                sunNeeds: 'Full sun (6+ hours)',
                fertPerYear: '3 - 5 lbs N per 1,000 sq ft',
                peakGrowth: 'Spring & Fall',
                dormancy: 'Goes dormant in summer heat (turns brown, recovers in fall)',
                bestFeature: 'Self-repairing via rhizomes - fills in bare spots naturally',
                commonIssues: ['Dollar spot', 'Summer patch', 'Necrotic ring spot', 'Needs more water than fescue'],
                keyTips: [
                    'Needs more sun than fescue - struggles below 6 hours direct sun',
                    'Will go dormant in summer but bounces back in fall',
                    'Slow to establish from seed (14-30 days germination)',
                    'Fall is the best time to seed and fertilize heavily'
                ],
                zoneNotes: {
                    '4': 'Premium choice - thrives in cold climates. The classic northern lawn grass.',
                    '5': 'Excellent. Standard KBG program works great.',
                    '6': 'Good but expect summer dormancy in hot years.',
                    '7': 'Difficult - summer stress is significant. Blend with tall fescue.',
                    '8': 'Not recommended without irrigation and shade.',
                    '9': 'Not viable - too hot.'
                },
                sources: [
                    { name: 'Penn State Extension', url: 'https://extension.psu.edu/lawn-care', topic: 'Kentucky Bluegrass Lawn Maintenance' },
                    { name: 'Michigan State Extension', url: 'https://www.canr.msu.edu/turf/kentucky-bluegrass', topic: 'Kentucky Bluegrass Care' },
                    { name: 'University of Minnesota Extension', url: 'https://extension.umn.edu/lawn-care/kentucky-bluegrass', topic: 'KBG for Northern Climates' }
                ]
            },
            'perennial-ryegrass': {
                name: 'Perennial Ryegrass',
                season: 'Cool Season',
                mowHeight: '1.5 - 2.5 inches',
                mowHeightSummer: '2.5 - 3 inches',
                waterPerWeek: '1 inch',
                idealSoilPH: '6.0 - 7.0',
                idealSoilTemp: '50 - 65¬∞F for growth',
                sunNeeds: 'Full sun to light shade',
                fertPerYear: '2 - 4 lbs N per 1,000 sq ft',
                peakGrowth: 'Spring & Fall',
                dormancy: 'Poor heat tolerance - can die in extreme heat',
                bestFeature: 'Fastest germination (5-10 days) - great for quick fill and overseeding',
                commonIssues: ['Gray leaf spot', 'Pythium blight', 'Poor heat/drought tolerance', 'Crown rust'],
                keyTips: [
                    'Best used in blends with KBG or fescue rather than as a standalone',
                    'Excellent for overseeding warm-season lawns in winter',
                    'Germinates very fast - great for quick repairs',
                    'Mow frequently to maintain density'
                ],
                zoneNotes: {
                    '4': 'Good in blends. Can winterkill in extreme cold.',
                    '5': 'Works well in blends with KBG.',
                    '6': 'Good for blends and overseeding.',
                    '7': 'Best as winter overseed for warm-season lawns.',
                    '8': 'Winter overseed only.',
                    '9': 'Winter overseed only.'
                },
                sources: [
                    { name: 'Rutgers Cooperative Extension', url: 'https://njaes.rutgers.edu/fs1316/', topic: 'Perennial Ryegrass Turf Management' },
                    { name: 'Penn State Extension', url: 'https://extension.psu.edu/lawn-care', topic: 'Perennial Ryegrass Maintenance' }
                ]
            },
            'bermuda': {
                name: 'Bermudagrass',
                season: 'Warm Season',
                mowHeight: '0.5 - 2 inches',
                mowHeightSummer: '1 - 2 inches',
                waterPerWeek: '1 - 1.25 inches',
                idealSoilPH: '6.0 - 6.5',
                idealSoilTemp: '65¬∞F+ for active growth',
                sunNeeds: 'Full sun required (8+ hours ideal)',
                fertPerYear: '3 - 5 lbs N per 1,000 sq ft',
                peakGrowth: 'Summer (June - August)',
                dormancy: 'Goes dormant and turns brown below 50¬∞F',
                bestFeature: 'Extremely aggressive growth - repairs damage quickly, excellent traffic tolerance',
                commonIssues: ['Spring dead spot', 'Large patch', 'Invasive into flower beds', 'Winter dormancy (brown)'],
                keyTips: [
                    'Do NOT fertilize until fully greened up in spring (soil 65¬∞F+)',
                    'Mow low and frequently for the best lawn',
                    'Scalp in early spring to remove brown thatch and speed green-up',
                    'Apply pre-emergent in late February/early March'
                ],
                zoneNotes: {
                    '4': 'Not viable - too cold.',
                    '5': 'Not recommended - winter damage is likely.',
                    '6': 'Marginal - only cold-hardy varieties (Latitude 36, NorthBridge).',
                    '7': 'Good with cold-hardy varieties. Expect 4-5 months dormancy.',
                    '8': 'Excellent - this is bermuda country.',
                    '9': 'Excellent - thrives with proper management.'
                },
                sources: [
                    { name: 'NC State Extension', url: 'https://content.ces.ncsu.edu/carolina-lawns', topic: 'Bermudagrass Maintenance' },
                    { name: 'Texas A&M AgriLife', url: 'https://agrilifeextension.tamu.edu/bermudagrass/', topic: 'Bermudagrass Management Guide' },
                    { name: 'UGA Extension', url: 'https://extension.uga.edu/publications/lawn-garden.html', topic: 'Bermudagrass Calendar' }
                ]
            },
            'zoysia': {
                name: 'Zoysiagrass',
                season: 'Warm Season',
                mowHeight: '1 - 2 inches',
                mowHeightSummer: '1.5 - 2 inches',
                waterPerWeek: '0.75 - 1 inch',
                idealSoilPH: '6.0 - 6.5',
                idealSoilTemp: '65¬∞F+ for active growth',
                sunNeeds: 'Full sun to moderate shade (4+ hours)',
                fertPerYear: '2 - 3 lbs N per 1,000 sq ft',
                peakGrowth: 'Late Spring - Summer',
                dormancy: 'Goes dormant below 55¬∞F - turns golden brown',
                bestFeature: 'Dense, carpet-like texture with good shade tolerance for a warm-season grass',
                commonIssues: ['Large patch disease', 'Slow to establish', 'Heavy thatch buildup', 'Slow spring green-up'],
                keyTips: [
                    'Patience required - zoysia is slow to spread and fill in',
                    'Dethatch or core aerate regularly to prevent thatch buildup',
                    'Needs less fertilizer than bermuda - don\'t over-feed',
                    'Last to green up in spring and first to go dormant in fall'
                ],
                zoneNotes: {
                    '4': 'Not recommended - too cold.',
                    '5': 'Marginal - only the hardiest varieties (Zenith, Meyer).',
                    '6': 'Good option with cold-hardy varieties. Expect long dormancy.',
                    '7': 'Excellent transition zone choice - good compromise grass.',
                    '8': 'Excellent performance.',
                    '9': 'Good but bermuda or st. augustine may perform better.'
                },
                sources: [
                    { name: 'Kansas State Extension', url: 'https://www.bookstore.ksre.ksu.edu/pubs/MF3280.pdf', topic: 'Zoysiagrass Lawn Care' },
                    { name: 'Clemson Extension', url: 'https://www.clemson.edu/extension/hgic/plants/landscape/lawns/hgic1214.html', topic: 'Zoysiagrass Maintenance' },
                    { name: 'NC State Extension', url: 'https://content.ces.ncsu.edu/carolina-lawns', topic: 'Zoysiagrass in the Transition Zone' }
                ]
            },
            'st-augustine': {
                name: 'St. Augustinegrass',
                season: 'Warm Season',
                mowHeight: '3 - 4 inches',
                mowHeightSummer: '3.5 - 4 inches',
                waterPerWeek: '1 - 1.5 inches',
                idealSoilPH: '6.0 - 6.5',
                idealSoilTemp: '65¬∞F+ for active growth',
                sunNeeds: 'Full sun to moderate shade (best warm-season shade tolerance)',
                fertPerYear: '2 - 4 lbs N per 1,000 sq ft',
                peakGrowth: 'Summer',
                dormancy: 'Goes dormant below 55¬∞F, sensitive to freeze damage',
                bestFeature: 'Best shade tolerance of any warm-season grass - thick, lush growth',
                commonIssues: ['Chinch bugs (major pest)', 'Gray leaf spot', 'SAD virus (St. Augustine Decline)', 'Poor cold tolerance'],
                keyTips: [
                    'Must be established by sod or plugs - no viable seed available',
                    'Keep mowing height high (3.5-4") for healthiest lawn',
                    'Watch closely for chinch bug damage in hot, dry periods',
                    'Do not over-fertilize with nitrogen - increases disease risk'
                ],
                zoneNotes: {
                    '4': 'Not viable.',
                    '5': 'Not viable.',
                    '6': 'Not viable - no cold tolerance.',
                    '7': 'Very risky - freeze damage likely.',
                    '8': 'Good in southern Zone 8. Protect from hard freezes.',
                    '9': 'Excellent - ideal climate for st. augustine.'
                },
                sources: [
                    { name: 'UF/IFAS Extension', url: 'https://edis.ifas.ufl.edu/topic-st-augustinegrass', topic: 'St. Augustinegrass for Florida Lawns' },
                    { name: 'Texas A&M AgriLife', url: 'https://agrilifeextension.tamu.edu/st-augustinegrass/', topic: 'St. Augustinegrass Management' },
                    { name: 'LSU AgCenter', url: 'https://www.lsuagcenter.com/topics/lawn_garden/lawns', topic: 'St. Augustinegrass Care' }
                ]
            }
        };

        // Zone climate descriptions
        const ZONE_INFO = {
            '4': { temp: '-30 to -20¬∞F', climate: 'Northern Cold', description: 'Long, cold winters. Short growing season. Cool-season grasses only.' },
            '5': { temp: '-20 to -10¬∞F', climate: 'Northern', description: 'Cold winters, moderate summers. Ideal for cool-season grasses.' },
            '6': { temp: '-10 to 0¬∞F', climate: 'Moderate', description: 'Moderate winters. Good for cool-season grasses, some warm-season with care.' },
            '7': { temp: '0 to 10¬∞F', climate: 'Transition Zone', description: 'The toughest zone for lawns. Both cool and warm-season grasses face challenges.' },
            '8': { temp: '10 to 20¬∞F', climate: 'Southern', description: 'Mild winters, hot summers. Warm-season grasses thrive here.' },
            '9': { temp: '20 to 30¬∞F', climate: 'Deep South / Gulf', description: 'Very mild winters, long hot summers. Warm-season grasses dominate.' }
        };

        function LawnCareTracker() {
            const [activities, setActivities] = useState([]);
            const [view, setView] = useState(null);
            const [selectedActivityType, setSelectedActivityType] = useState(null);
            const [formData, setFormData] = useState({});
            const [weather, setWeather] = useState(null);
            const [weatherLoading, setWeatherLoading] = useState(true);
            const [equipment, setEquipment] = useState([]);
            const [lawnProfile, setLawnProfile] = useState(null);
            const [statsView, setStatsView] = useState('year');

            useEffect(() => {
                const stored = localStorage.getItem('lawnCareActivities');
                if (stored) setActivities(JSON.parse(stored));
                
                const storedEquipment = localStorage.getItem('lawnCareEquipment');
                if (storedEquipment) setEquipment(JSON.parse(storedEquipment));
                
                const storedProfile = localStorage.getItem('lawnProfile');
                if (storedProfile) setLawnProfile(JSON.parse(storedProfile));
                
                fetchWeatherData();
            }, []);

            const fetchWeatherData = async () => {
                try {
                    const lat = 40.1014;
                    const lon = -83.0235;
                    
                    const response = await fetch(
                        `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m&daily=temperature_2m_max,temperature_2m_min,precipitation_sum&temperature_unit=fahrenheit&precipitation_unit=inch&timezone=auto&past_days=7`
                    );
                    
                    const data = await response.json();
                    const airTemp = data.current.temperature_2m;
                    const soilTemp = Math.round(airTemp - 7);
                    
                    let weeklyRainfall = 0;
                    if (data.daily?.precipitation_sum) {
                        weeklyRainfall = data.daily.precipitation_sum.reduce((sum, val) => sum + val, 0);
                        weeklyRainfall = Math.round(weeklyRainfall * 10) / 10;
                    }
                    
                    setWeather({
                        temperature: Math.round(airTemp),
                        soilTemp: soilTemp,
                        humidity: data.current.relative_humidity_2m,
                        highTemp: Math.round(data.daily.temperature_2m_max[0]),
                        lowTemp: Math.round(data.daily.temperature_2m_min[0]),
                        rainfall: weeklyRainfall,
                        location: 'Columbus, OH'
                    });
                    
                    setWeatherLoading(false);
                } catch (error) {
                    console.error('Weather fetch error:', error);
                    setWeatherLoading(false);
                }
            };

            useEffect(() => {
                localStorage.setItem('lawnCareActivities', JSON.stringify(activities));
            }, [activities]);

            const addActivity = (activityData) => {
                const newActivity = {
                    id: Date.now(),
                    type: selectedActivityType,
                    date: activityData.date,
                    notes: activityData.notes,
                    data: activityData.data,
                    createdAt: new Date().toISOString()
                };
                
                setActivities([...activities, newActivity]);
                alert('‚úÖ Activity saved!');
                setView(null);
                setSelectedActivityType(null);
            };

            const deleteActivity = (id) => {
                if (confirm('Delete this activity?')) {
                    setActivities(activities.filter(a => a.id !== id));
                }
            };

            const addEquipment = (equipmentData) => {
                const newEquipment = {
                    id: Date.now(),
                    ...equipmentData,
                    createdAt: new Date().toISOString()
                };
                const updated = [...equipment, newEquipment];
                setEquipment(updated);
                localStorage.setItem('lawnCareEquipment', JSON.stringify(updated));
            };

            const deleteEquipment = (id) => {
                if (confirm('Remove this equipment?')) {
                    const updated = equipment.filter(e => e.id !== id);
                    setEquipment(updated);
                    localStorage.setItem('lawnCareEquipment', JSON.stringify(updated));
                }
            };

            const SeasonBanner = () => {
                const month = new Date().getMonth();
                let bannerText, bannerBg, bannerBorder, bannerIcon;
                if (weather && weather.soilTemp < 45) {
                    bannerText = 'Dormant Season ‚Äî Plan your spring pre-emergent timing';
                    bannerBg = 'bg-blue-50'; bannerBorder = 'border-blue-400'; bannerIcon = '‚ùÑÔ∏è';
                } else if (weather && weather.soilTemp >= 45 && weather.soilTemp < 55) {
                    bannerText = 'Early Spring ‚Äî Soil warming up, pre-emergent window opening';
                    bannerBg = 'bg-amber-50'; bannerBorder = 'border-amber-400'; bannerIcon = 'üå§Ô∏è';
                } else if (weather && weather.soilTemp >= 55 && weather.soilTemp <= 70) {
                    bannerText = 'Active Growing Season ‚Äî Prime time for lawn care';
                    bannerBg = 'bg-[#e8f5e9]'; bannerBorder = 'border-[#367C2B]'; bannerIcon = 'üå±';
                } else if (weather && weather.soilTemp > 70 && weather.soilTemp <= 85) {
                    bannerText = 'Peak Summer ‚Äî Focus on watering and mow height';
                    bannerBg = 'bg-orange-50'; bannerBorder = 'border-orange-400'; bannerIcon = '‚òÄÔ∏è';
                } else if (weather && weather.soilTemp > 85) {
                    bannerText = 'Heat Stress ‚Äî Water deeply, raise mow height';
                    bannerBg = 'bg-red-50'; bannerBorder = 'border-red-400'; bannerIcon = 'üî•';
                } else if (month >= 10 || month <= 1) {
                    bannerText = 'Dormant Season ‚Äî Plan your spring pre-emergent timing';
                    bannerBg = 'bg-blue-50'; bannerBorder = 'border-blue-400'; bannerIcon = '‚ùÑÔ∏è';
                } else if (month >= 2 && month <= 4) {
                    bannerText = 'Spring Season ‚Äî Time for pre-emergent and first feeds';
                    bannerBg = 'bg-[#e8f5e9]'; bannerBorder = 'border-[#367C2B]'; bannerIcon = 'üå±';
                } else if (month >= 5 && month <= 7) {
                    bannerText = 'Summer Season ‚Äî Focus on watering and mow height';
                    bannerBg = 'bg-orange-50'; bannerBorder = 'border-orange-400'; bannerIcon = '‚òÄÔ∏è';
                } else {
                    bannerText = 'Fall Season ‚Äî Best time to overseed and fertilize';
                    bannerBg = 'bg-amber-50'; bannerBorder = 'border-amber-400'; bannerIcon = 'üçÇ';
                }

                return (
                    <div className={`${bannerBg} border-l-4 ${bannerBorder} px-4 py-2.5 animate-fade-in`}>
                        <div className="max-w-5xl mx-auto flex items-center gap-2">
                            <span className="text-lg">{bannerIcon}</span>
                            <span className="text-sm font-semibold text-gray-700">{bannerText}</span>
                        </div>
                    </div>
                );
            };

            const WeatherSnapshot = () => {
                if (weatherLoading) {
                    return <div className="bg-white rounded-lg shadow-md p-6 mb-6">Loading weather...</div>;
                }

                if (!weather) return null;

                let recommendation = '';
                if (weather.soilTemp < 50) {
                    recommendation = '‚ùÑÔ∏è Soil too cold for most activities';
                } else if (weather.soilTemp >= 50 && weather.soilTemp <= 65) {
                    recommendation = 'üå± Good for cool-season grass care';
                } else if (weather.soilTemp > 65 && weather.soilTemp <= 85) {
                    recommendation = '‚òÄÔ∏è Ideal growing conditions';
                } else {
                    recommendation = 'üî• Very warm - focus on watering';
                }

                return (
                    <div className="mb-6 animate-fade-in">
                        <div className="bg-white rounded-xl shadow-md p-4 mb-3 border-l-4 border-[#367C2B]">
                            <h3 className="text-xs font-bold text-[#367C2B] uppercase mb-3">Current Conditions - {weather.location}</h3>
                            <div className="grid grid-cols-2 gap-3">
                                <div className="text-center p-2 border-r-2 border-[#367C2B]/20">
                                    <div className="text-3xl font-bold text-[#367C2B]">{weather.temperature}¬∞</div>
                                    <div className="text-xs text-gray-600 mt-1">Air Temp</div>
                                    <div className="text-xs text-gray-500">H: {weather.highTemp}¬∞ L: {weather.lowTemp}¬∞</div>
                                </div>
                                <div className="text-center p-2">
                                    <div className="text-3xl font-bold text-[#367C2B]">{weather.soilTemp}¬∞</div>
                                    <div className="text-xs text-gray-600 mt-1">Soil Temp</div>
                                    <div className="text-xs text-gray-500">est. at 4" depth</div>
                                </div>
                            </div>
                            <div className="grid grid-cols-2 gap-3 mt-3 pt-3 border-t border-gray-100">
                                <div className="text-center">
                                    <div className="text-xl font-bold text-[#367C2B]">{weather.humidity}%</div>
                                    <div className="text-xs text-gray-600">Humidity</div>
                                </div>
                                <div className="text-center">
                                    <div className="text-xl font-bold text-[#367C2B]">{weather.rainfall}"</div>
                                    <div className="text-xs text-gray-600">Weekly Rain</div>
                                </div>
                            </div>
                        </div>

                        <div className="bg-[#e8f5e9] rounded-xl p-4 border-l-4 border-[#4a7c2c]">
                            <div className="font-bold text-sm text-[#367C2B] mb-1">Recommendation:</div>
                            <div className="text-sm text-gray-700">{recommendation}</div>
                        </div>

                        {activities.length > 0 && (() => {
                            const lastActivity = activities[activities.length - 1];
                            const colors = ACTIVITY_COLORS[lastActivity.type] || ACTIVITY_COLORS.mowing;
                            return (
                                <div className={`bg-white rounded-xl shadow-md p-4 mt-3 border-l-4 ${colors.border} card-hover`}>
                                    <h3 className={`text-xs font-bold ${colors.text} uppercase mb-3`}>Last Activity</h3>
                                    <div className="flex items-center gap-3">
                                        <div className="text-4xl">{ACTIVITY_TYPES[lastActivity.type].icon}</div>
                                        <div className="flex-1">
                                            <div className={`text-base font-bold ${colors.text}`}>
                                                {ACTIVITY_TYPES[lastActivity.type].name}
                                            </div>
                                            <div className="text-xs text-gray-600 mt-1">
                                                {(() => {
                                                    const days = Math.floor((new Date() - new Date(lastActivity.date)) / (1000 * 60 * 60 * 24));
                                                    return days === 0 ? 'Today' : days === 1 ? 'Yesterday' : `${days} days ago`;
                                                })()}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            );
                        })()}
                    </div>
                );
            };

            const ActivitySelector = () => (
                <div className="animate-fade-in">
                    <h2 className="text-xl font-bold mb-4">Select Activity Type</h2>
                    <div className="grid grid-cols-2 gap-3">
                        {Object.entries(ACTIVITY_TYPES).map(([key, type]) => {
                            const colors = ACTIVITY_COLORS[key] || ACTIVITY_COLORS.mowing;
                            return (
                                <button
                                    key={key}
                                    onClick={() => setSelectedActivityType(key)}
                                    className={`${colors.bg} border-2 ${colors.border}/30 hover:${colors.border} p-4 rounded-xl shadow-md card-hover btn-press`}
                                    style={{borderColor: colors.hex + '4D'}}
                                    onMouseEnter={(e) => e.currentTarget.style.borderColor = colors.hex}
                                    onMouseLeave={(e) => e.currentTarget.style.borderColor = colors.hex + '4D'}
                                >
                                    <div className="text-4xl mb-2">{type.icon}</div>
                                    <div className={`text-sm font-bold ${colors.text}`}>{type.name}</div>
                                </button>
                            );
                        })}
                    </div>
                    <button onClick={() => setView(null)} className="mt-4 px-4 py-2 bg-gray-200 rounded-lg btn-press">
                        Cancel
                    </button>
                </div>
            );

            const ActivityForm = () => {
                const activityType = ACTIVITY_TYPES[selectedActivityType];
                const [localFormData, setLocalFormData] = useState({
                    date: new Date().toISOString().split('T')[0],
                    notes: '',
                    data: {}
                });

                return (
                    <div>
                        <h2 className="text-2xl font-bold mb-6 flex items-center gap-3">
                            <span className="text-4xl">{activityType.icon}</span>
                            {activityType.name}
                        </h2>
                        
                        <form onSubmit={(e) => { e.preventDefault(); addActivity(localFormData); }} className="bg-white rounded-lg shadow-lg p-6">
                            <div className="mb-4">
                                <label className="block text-sm font-semibold mb-2">Date</label>
                                <input
                                    type="date"
                                    required
                                    value={localFormData.date}
                                    onChange={(e) => setLocalFormData({...localFormData, date: e.target.value})}
                                    className="w-full px-4 py-2 border rounded-lg"
                                />
                            </div>

                            {activityType.fields.map(field => (
                                <div key={field.name} className="mb-4">
                                    <label className="block text-sm font-semibold mb-2">
                                        {field.label}
                                        {field.required && <span className="text-red-600 ml-1">*</span>}
                                    </label>
                                    
                                    {field.type === 'treatment-category' ? (
                                        <div className="grid grid-cols-2 gap-3">
                                            {Object.entries(TREATMENT_CATEGORIES).map(([key, cat]) => (
                                                <button
                                                    key={key}
                                                    type="button"
                                                    onClick={() => setLocalFormData({
                                                        ...localFormData,
                                                        data: {...localFormData.data, category: key, product: ''}
                                                    })}
                                                    className={`p-3 rounded-lg border-2 ${
                                                        localFormData.data.category === key
                                                            ? 'bg-[#367C2B] text-white'
                                                            : 'bg-white'
                                                    }`}
                                                >
                                                    <div className="text-xl">{cat.icon}</div>
                                                    <div className="text-sm">{cat.label}</div>
                                                </button>
                                            ))}
                                        </div>
                                    ) : field.type === 'treatment-product' ? (
                                        localFormData.data.category ? (
                                            <div>
                                                <select
                                                    onChange={(e) => setLocalFormData({
                                                        ...localFormData,
                                                        data: {...localFormData.data, product: e.target.value}
                                                    })}
                                                    className="w-full px-4 py-2 border rounded-lg"
                                                    required={field.required}
                                                >
                                                    <option value="">Select...</option>
                                                    {(TREATMENT_PRODUCTS[localFormData.data.category] || []).map(p => (
                                                        <option key={p.id} value={p.name}>{p.name}</option>
                                                    ))}
                                                </select>
                                                {(() => {
                                                    const selectedProduct = (TREATMENT_PRODUCTS[localFormData.data.category] || []).find(p => p.name === localFormData.data.product);
                                                    if (!selectedProduct || selectedProduct.id.includes('5')) return null;
                                                    return (
                                                        <div className="mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                                            <div className="text-xs font-bold text-blue-800 uppercase mb-2">Product Details</div>
                                                            <div className="grid grid-cols-2 gap-2">
                                                                {selectedProduct.activeIngredient && (
                                                                    <div>
                                                                        <div className="text-xs text-gray-500">Active Ingredient</div>
                                                                        <div className="text-xs font-semibold text-gray-800">{selectedProduct.activeIngredient}</div>
                                                                    </div>
                                                                )}
                                                                {selectedProduct.rate && (
                                                                    <div>
                                                                        <div className="text-xs text-gray-500">Application Rate</div>
                                                                        <div className="text-xs font-semibold text-gray-800">{selectedProduct.rate}</div>
                                                                    </div>
                                                                )}
                                                                {selectedProduct.timing && (
                                                                    <div>
                                                                        <div className="text-xs text-gray-500">Timing</div>
                                                                        <div className="text-xs font-semibold text-gray-800">{selectedProduct.timing}</div>
                                                                    </div>
                                                                )}
                                                                {selectedProduct.target && (
                                                                    <div>
                                                                        <div className="text-xs text-gray-500">Target</div>
                                                                        <div className="text-xs font-semibold text-gray-800">{selectedProduct.target}</div>
                                                                    </div>
                                                                )}
                                                                {selectedProduct.effect && (
                                                                    <div>
                                                                        <div className="text-xs text-gray-500">Effect</div>
                                                                        <div className="text-xs font-semibold text-gray-800">{selectedProduct.effect}</div>
                                                                    </div>
                                                                )}
                                                            </div>
                                                            {selectedProduct.notes && (
                                                                <div className="mt-2 text-xs text-gray-600 italic">{selectedProduct.notes}</div>
                                                            )}
                                                        </div>
                                                    );
                                                })()}
                                            </div>
                                        ) : (
                                            <div className="p-4 bg-yellow-50 border rounded">Select category first</div>
                                        )
                                    ) : field.type === 'product-select' ? (
                                        (() => {
                                            let products = PRODUCT_DATABASE[field.productType] || [];
                                            if (field.filterBy && localFormData.data[field.filterBy]) {
                                                const filterVal = localFormData.data[field.filterBy];
                                                products = products.filter(p => p[field.filterProp] === filterVal || p.id.includes('-other'));
                                            }
                                            return (
                                                <select
                                                    onChange={(e) => setLocalFormData({
                                                        ...localFormData,
                                                        data: {...localFormData.data, [field.name]: e.target.value}
                                                    })}
                                                    className="w-full px-4 py-2 border rounded-lg"
                                                >
                                                    <option value="">Select...</option>
                                                    {products.map(p => (
                                                        <option key={p.id} value={p.name}>{p.brand} - {p.name} {p.deck ? `(${p.deck})` : ''}</option>
                                                    ))}
                                                </select>
                                            );
                                        })()
                                    ) : field.type === 'select' ? (
                                        <select
                                            onChange={(e) => setLocalFormData({
                                                ...localFormData,
                                                data: {...localFormData.data, [field.name]: e.target.value}
                                            })}
                                            className="w-full px-4 py-2 border rounded-lg"
                                        >
                                            <option value="">Select...</option>
                                            {field.options.map(opt => (
                                                <option key={opt} value={opt}>{opt}</option>
                                            ))}
                                        </select>
                                    ) : (
                                        <input
                                            type={field.type}
                                            placeholder={field.placeholder}
                                            onChange={(e) => setLocalFormData({
                                                ...localFormData,
                                                data: {...localFormData.data, [field.name]: e.target.value}
                                            })}
                                            className="w-full px-4 py-2 border rounded-lg"
                                        />
                                    )}
                                </div>
                            ))}

                            <div className="mb-4">
                                <label className="block text-sm font-semibold mb-2">Notes (Optional)</label>
                                <textarea
                                    onChange={(e) => setLocalFormData({...localFormData, notes: e.target.value})}
                                    rows="3"
                                    className="w-full px-4 py-2 border rounded-lg"
                                />
                            </div>

                            <div className="flex gap-4">
                                <button type="submit" className="flex-1 px-6 py-3 bg-[#367C2B] text-white rounded-lg font-semibold">
                                    Save Activity
                                </button>
                                <button type="button" onClick={() => { setSelectedActivityType(null); setView(null); }} className="px-6 py-3 bg-gray-200 rounded-lg">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                );
            };

            const ActivityDetails = ({ activity }) => {
                const activityType = ACTIVITY_TYPES[activity.type];
                if (!activityType || !activity.data) return null;
                const fields = activityType.fields || [];
                const details = fields
                    .filter(f => activity.data[f.name])
                    .map(f => {
                        let value = activity.data[f.name];
                        if (f.name === 'category' && TREATMENT_CATEGORIES[value]) {
                            value = TREATMENT_CATEGORIES[value].icon + ' ' + TREATMENT_CATEGORIES[value].label;
                        }
                        return { label: f.label, value };
                    });
                if (details.length === 0 && !activity.notes) return null;
                return (
                    <div className="mt-3 pt-3 border-t border-gray-200">
                        {details.length > 0 && (
                            <div className="grid grid-cols-2 gap-x-4 gap-y-2">
                                {details.map(d => (
                                    <div key={d.label}>
                                        <div className="text-xs text-gray-500 uppercase tracking-wide">{d.label}</div>
                                        <div className="text-sm font-medium text-gray-800">{d.value}</div>
                                    </div>
                                ))}
                            </div>
                        )}
                        {activity.notes && (
                            <div className="mt-2">
                                <div className="text-xs text-gray-500 uppercase tracking-wide">Notes</div>
                                <div className="text-sm text-gray-700">{activity.notes}</div>
                            </div>
                        )}
                    </div>
                );
            };

            const HistoryView = () => {
                const sorted = [...activities].sort((a, b) => new Date(b.date) - new Date(a.date));
                const [expandedId, setExpandedId] = useState(null);

                return (
                    <div className="animate-fade-in">
                        <h2 className="text-2xl font-bold mb-6">Activity History</h2>
                        {sorted.length === 0 ? (
                            <div className="bg-white rounded-lg shadow-md p-8 text-center text-gray-500">
                                No activities yet
                            </div>
                        ) : (
                            <div className="space-y-3">
                                {sorted.map(activity => {
                                    const colors = ACTIVITY_COLORS[activity.type] || ACTIVITY_COLORS.mowing;
                                    return (
                                        <div key={activity.id} className={`bg-white rounded-xl shadow-md p-4 cursor-pointer card-hover border-l-4 ${colors.border}`} onClick={() => setExpandedId(expandedId === activity.id ? null : activity.id)}>
                                            <div className="flex justify-between items-center">
                                                <div className="flex gap-3 items-center">
                                                    <div className="text-3xl">{ACTIVITY_TYPES[activity.type].icon}</div>
                                                    <div>
                                                        <h3 className={`text-lg font-bold ${colors.text}`}>{ACTIVITY_TYPES[activity.type].name}</h3>
                                                        <p className="text-sm text-gray-500">{new Date(activity.date).toLocaleDateString()}</p>
                                                    </div>
                                                </div>
                                                <div className="flex items-center gap-3">
                                                    <span className="text-gray-400 text-sm">{expandedId === activity.id ? '‚ñ≤' : '‚ñº'}</span>
                                                    <button onClick={(e) => { e.stopPropagation(); deleteActivity(activity.id); }} className="text-red-500 hover:text-red-700 btn-press text-sm">
                                                        Delete
                                                    </button>
                                                </div>
                                            </div>
                                            {expandedId === activity.id && <ActivityDetails activity={activity} />}
                                        </div>
                                    );
                                })}
                            </div>
                        )}
                    </div>
                );
            };

            const MyGarage = () => {
                const [garageForm, setGarageForm] = useState({ name: '', type: 'mowers', selectedProduct: '', customName: '', mowerType: '' });

                const allProducts = PRODUCT_DATABASE[garageForm.type] || [];
                const currentProducts = (garageForm.type === 'mowers' && garageForm.mowerType)
                    ? allProducts.filter(p => p.mowerCategory === garageForm.mowerType || p.id.includes('-other'))
                    : allProducts;
                const selectedProductData = currentProducts.find(p => p.id === garageForm.selectedProduct);

                const handleTypeChange = (newType) => {
                    setGarageForm({ name: '', type: newType, selectedProduct: '', customName: '', mowerType: '' });
                };

                const handleProductSelect = (productId) => {
                    const product = currentProducts.find(p => p.id === productId);
                    if (product && !product.id.includes('-other')) {
                        setGarageForm({ ...garageForm, selectedProduct: productId, name: product.name, customName: '' });
                    } else {
                        setGarageForm({ ...garageForm, selectedProduct: productId, name: '', customName: '' });
                    }
                };

                const handleSubmit = (e) => {
                    e.preventDefault();
                    const finalName = garageForm.selectedProduct && !garageForm.selectedProduct.includes('-other')
                        ? garageForm.name
                        : garageForm.customName;
                    if (finalName) {
                        const productInfo = selectedProductData || {};
                        addEquipment({
                            name: finalName,
                            type: garageForm.type,
                            brand: productInfo.brand || 'Custom',
                            details: productInfo.features || productInfo.type || '',
                            deck: productInfo.deck || '',
                            maintenanceSchedule: productInfo.maintenanceSchedule || null
                        });
                        setGarageForm({ name: '', type: garageForm.type, selectedProduct: '', customName: '' });
                    }
                };

                const typeLabels = { mowers: 'Mower', spreaders: 'Spreader', trimmers: 'Trimmer' };
                const typeImages = { mowers: 'activity-mowing.png', spreaders: 'activity-fertilizer.png', trimmers: 'activity-trimming.png' };

                return (
                    <div>
                        <div className="flex items-center justify-between mb-4">
                            <h2 className="text-xl font-bold">üè† My Garage</h2>
                            <button onClick={() => setView('products')} className="px-3 py-1 text-xs font-semibold text-[#367C2B] border border-[#367C2B] rounded-lg hover:bg-[#367C2B]/10">
                                üìñ Product Guide
                            </button>
                        </div>

                        <div className="bg-white rounded-lg shadow-md p-4 mb-4">
                            <h3 className="font-bold mb-4">Add Equipment</h3>
                            <form onSubmit={handleSubmit}>
                                <div className="mb-4">
                                    <label className="block text-sm font-semibold mb-2">Equipment Type</label>
                                    <div className="grid grid-cols-3 gap-2">
                                        {Object.entries(typeLabels).map(([key, label]) => (
                                            <button
                                                key={key}
                                                type="button"
                                                onClick={() => handleTypeChange(key)}
                                                className={`p-3 rounded-lg text-center transition btn-press ${
                                                    garageForm.type === key
                                                        ? 'bg-[#367C2B]/10 text-[#367C2B] border-2 border-[#367C2B] shadow-md ring-1 ring-[#367C2B]/30'
                                                        : 'bg-white text-gray-700 border-2 border-gray-200 hover:border-[#367C2B]'
                                                }`}
                                            >
                                                <div className="w-12 h-12 mx-auto rounded-full overflow-hidden bg-white">
                                                    <img
                                                        src={typeImages[key]}
                                                        alt={label}
                                                        className="w-full h-full object-cover"
                                                    />
                                                </div>
                                                <div className={`text-xs font-semibold mt-1 ${garageForm.type === key ? 'text-[#367C2B]' : ''}`}>{label}</div>
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                {garageForm.type === 'mowers' && (
                                    <div className="mb-4">
                                        <label className="block text-sm font-semibold mb-2">Mower Type</label>
                                        <div className="grid grid-cols-3 gap-2">
                                            {['Walk Behind', 'Riding', 'Zero Turn'].map(mt => (
                                                <button
                                                    key={mt}
                                                    type="button"
                                                    onClick={() => setGarageForm({ ...garageForm, mowerType: mt, selectedProduct: '', name: '', customName: '' })}
                                                    className={`p-2 rounded-lg border-2 text-center text-sm font-semibold transition ${
                                                        garageForm.mowerType === mt
                                                            ? 'bg-[#367C2B] text-white border-[#367C2B]'
                                                            : 'bg-white text-gray-700 border-gray-200 hover:border-[#367C2B]'
                                                    }`}
                                                >
                                                    {mt}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                <div className="mb-4">
                                    <label className="block text-sm font-semibold mb-2">Select {typeLabels[garageForm.type]}</label>
                                    <select
                                        value={garageForm.selectedProduct}
                                        onChange={(e) => handleProductSelect(e.target.value)}
                                        className="w-full px-4 py-2 border rounded-lg"
                                    >
                                        <option value="">Choose from {currentProducts.length} models...</option>
                                        {currentProducts.map(p => (
                                            <option key={p.id} value={p.id}>
                                                {p.brand} - {p.name} {p.deck ? `(${p.deck})` : ''} {p.type ? `- ${p.type}` : ''}
                                            </option>
                                        ))}
                                    </select>
                                </div>

                                {garageForm.selectedProduct && garageForm.selectedProduct.includes('-other') && (
                                    <div className="mb-4">
                                        <label className="block text-sm font-semibold mb-2">Custom Name</label>
                                        <input
                                            type="text"
                                            value={garageForm.customName}
                                            onChange={(e) => setGarageForm({...garageForm, customName: e.target.value})}
                                            placeholder="Enter your equipment name"
                                            className="w-full px-4 py-2 border rounded-lg"
                                        />
                                    </div>
                                )}

                                {selectedProductData && !garageForm.selectedProduct.includes('-other') && (
                                    <div className="mb-4 p-3 bg-green-50 border border-green-200 rounded-lg">
                                        <div className="text-sm font-semibold text-[#367C2B]">{selectedProductData.brand} {selectedProductData.name}</div>
                                        {selectedProductData.features && <div className="text-xs text-gray-600 mt-1">{selectedProductData.features}</div>}
                                        {selectedProductData.deck && <div className="text-xs text-gray-600">Deck: {selectedProductData.deck}</div>}
                                        {selectedProductData.type && <div className="text-xs text-gray-600">Type: {selectedProductData.type}</div>}
                                        {selectedProductData.maintenanceSchedule && selectedProductData.maintenanceSchedule.note && (
                                            <div className="text-xs text-gray-500 mt-1 italic">{selectedProductData.maintenanceSchedule.note}</div>
                                        )}
                                    </div>
                                )}

                                <button
                                    type="submit"
                                    disabled={!garageForm.selectedProduct || (garageForm.selectedProduct.includes('-other') && !garageForm.customName)}
                                    className="w-full px-4 py-2 bg-[#367C2B] text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed"
                                >
                                    Add to Garage
                                </button>
                            </form>
                        </div>

                        <div className="bg-white rounded-lg shadow p-4">
                            <h3 className="font-bold mb-4">Your Equipment ({equipment.length})</h3>
                            {equipment.length === 0 ? (
                                <p className="text-gray-500 text-center py-6">No equipment yet ‚Äî add your first piece above!</p>
                            ) : (
                                <div className="space-y-3">
                                    {equipment.map(item => {
                                        const maintenanceLogs = activities.filter(a => a.type === 'maintenance' && a.data && a.data.equipmentType && item.name.toLowerCase().includes(a.data.equipmentType.toLowerCase()));
                                        const mowingHours = item.type === 'mowers'
                                            ? activities.filter(a => a.type === 'mowing' && a.data && a.data.mowerUsed === item.name).reduce((sum, a) => sum + (parseFloat(a.data.duration) || 45) / 60, 0)
                                            : 0;
                                        const schedule = item.maintenanceSchedule;

                                        return (
                                            <div key={item.id} className="bg-gray-50 p-4 rounded-lg">
                                                <div className="flex justify-between items-start">
                                                    <div className="flex gap-3">
                                                        <img
                                                            src={typeImages[item.type] || 'activity-general.png'}
                                                            alt={typeLabels[item.type] || item.type}
                                                            className="w-12 h-12 object-contain"
                                                        />
                                                        <div>
                                                            <div className="font-bold">{item.name}</div>
                                                            {item.brand && item.brand !== 'Custom' && (
                                                                <div className="text-sm text-[#367C2B] font-semibold">{item.brand}</div>
                                                            )}
                                                            <div className="text-xs text-gray-500 capitalize">{typeLabels[item.type] || item.type}</div>
                                                            {item.details && <div className="text-xs text-gray-500 mt-1">{item.details}</div>}
                                                        </div>
                                                    </div>
                                                    <button onClick={() => deleteEquipment(item.id)} className="px-3 py-1 bg-red-100 text-red-700 rounded text-sm">
                                                        Remove
                                                    </button>
                                                </div>

                                                {/* Maintenance schedule display */}
                                                {schedule && (
                                                    <div className="mt-3 pt-3 border-t border-gray-200">
                                                        <div className="text-xs font-bold text-[#367C2B] uppercase mb-2">Maintenance Schedule</div>
                                                        {schedule.note ? (
                                                            <div className="text-xs text-gray-500 italic">{schedule.note}</div>
                                                        ) : (
                                                            <div className="space-y-1">
                                                                {item.type === 'mowers' && (
                                                                    <div className="text-xs text-gray-600 mb-2">
                                                                        Estimated hours logged: <span className="font-bold text-[#367C2B]">{Math.round(mowingHours * 10) / 10} hrs</span>
                                                                    </div>
                                                                )}
                                                                <div className="grid grid-cols-2 gap-2">
                                                                    {schedule.oilChange && (
                                                                        <div className={`text-xs p-2 rounded ${mowingHours >= schedule.oilChange ? 'bg-red-50 border border-red-200' : 'bg-gray-100'}`}>
                                                                            <span className="font-semibold">Oil Change:</span> Every {schedule.oilChange} hrs
                                                                            {mowingHours >= schedule.oilChange && <div className="text-red-600 font-bold mt-0.5">Due now</div>}
                                                                        </div>
                                                                    )}
                                                                    {schedule.airFilter && (
                                                                        <div className={`text-xs p-2 rounded ${typeof schedule.airFilter === 'number' && mowingHours >= schedule.airFilter ? 'bg-red-50 border border-red-200' : 'bg-gray-100'}`}>
                                                                            <span className="font-semibold">Air Filter:</span> {typeof schedule.airFilter === 'number' ? `Every ${schedule.airFilter} hrs` : schedule.airFilter}
                                                                            {typeof schedule.airFilter === 'number' && mowingHours >= schedule.airFilter && <div className="text-red-600 font-bold mt-0.5">Due now</div>}
                                                                        </div>
                                                                    )}
                                                                    {schedule.sparkPlug && (
                                                                        <div className={`text-xs p-2 rounded ${typeof schedule.sparkPlug === 'number' && mowingHours >= schedule.sparkPlug ? 'bg-red-50 border border-red-200' : 'bg-gray-100'}`}>
                                                                            <span className="font-semibold">Spark Plug:</span> {typeof schedule.sparkPlug === 'number' ? `Every ${schedule.sparkPlug} hrs` : schedule.sparkPlug}
                                                                            {typeof schedule.sparkPlug === 'number' && mowingHours >= schedule.sparkPlug && <div className="text-red-600 font-bold mt-0.5">Due now</div>}
                                                                        </div>
                                                                    )}
                                                                    {schedule.bladeService && (
                                                                        <div className="text-xs p-2 rounded bg-gray-100">
                                                                            <span className="font-semibold">Blade Service:</span> {schedule.bladeService}
                                                                        </div>
                                                                    )}
                                                                    {schedule.cleaning && (
                                                                        <div className="text-xs p-2 rounded bg-gray-100">
                                                                            <span className="font-semibold">Cleaning:</span> {schedule.cleaning}
                                                                        </div>
                                                                    )}
                                                                    {schedule.lubrication && (
                                                                        <div className="text-xs p-2 rounded bg-gray-100">
                                                                            <span className="font-semibold">Lubrication:</span> {schedule.lubrication}
                                                                        </div>
                                                                    )}
                                                                    {schedule.tires && (
                                                                        <div className="text-xs p-2 rounded bg-gray-100">
                                                                            <span className="font-semibold">Tires:</span> {schedule.tires}
                                                                        </div>
                                                                    )}
                                                                    {schedule.battery && (
                                                                        <div className="text-xs p-2 rounded bg-gray-100">
                                                                            <span className="font-semibold">Battery:</span> {schedule.battery}
                                                                        </div>
                                                                    )}
                                                                    {schedule.gearbox && (
                                                                        <div className="text-xs p-2 rounded bg-gray-100">
                                                                            <span className="font-semibold">Gearbox:</span> {schedule.gearbox}
                                                                        </div>
                                                                    )}
                                                                </div>
                                                            </div>
                                                        )}
                                                    </div>
                                                )}
                                            </div>
                                        );
                                    })}
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            const LawnProfile = () => {
                const [profileData, setProfileData] = useState(lawnProfile || {
                    lawnSize: '',
                    zone: '',
                    specificGrass: '',
                    soilType: ''
                });
                const [editing, setEditing] = useState(!lawnProfile || !lawnProfile.specificGrass || !lawnProfile.zone);

                const save = () => {
                    localStorage.setItem('lawnProfile', JSON.stringify(profileData));
                    setLawnProfile(profileData);
                    setEditing(false);
                };

                const grassInfo = GRASS_INFO[profileData.specificGrass];
                const zoneInfo = ZONE_INFO[profileData.zone];

                // Get current month tasks from grassPrograms if available
                const getCurrentMonthTasks = () => {
                    if (!profileData.specificGrass || !profileData.zone) return null;
                    const keyMap = {
                        'tall-fescue': 'tallFescue',
                        'kentucky-bluegrass': 'kentuckyBluegrass',
                        'perennial-ryegrass': 'perennialRyegrass',
                        'bermuda': 'bermuda',
                        'zoysia': 'zoysia',
                        'st-augustine': 'stAugustine'
                    };
                    const programKey = keyMap[profileData.specificGrass] + '_zone' + profileData.zone;
                    const program = typeof grassPrograms !== 'undefined' ? grassPrograms[programKey] : null;
                    if (!program || !program.schedule) return null;

                    const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
                    const currentMonth = months[new Date().getMonth()];

                    // Find exact month match or a range match (e.g. "June-August")
                    return program.schedule.find(s => {
                        if (s.month === currentMonth) return true;
                        if (s.month && s.month.includes('-')) {
                            const parts = s.month.split('-');
                            const startIdx = months.indexOf(parts[0]);
                            const endIdx = months.indexOf(parts[1]);
                            const curIdx = months.indexOf(currentMonth);
                            if (startIdx >= 0 && endIdx >= 0 && curIdx >= startIdx && curIdx <= endIdx) return true;
                        }
                        return false;
                    });
                };

                const currentTasks = getCurrentMonthTasks();

                // Edit form
                if (editing) {
                    return (
                        <div>
                            <h2 className="text-2xl font-bold mb-6">üå± Lawn Profile</h2>
                            <div className="bg-white rounded-lg shadow p-4 space-y-4">
                                <div>
                                    <label className="block text-sm font-medium mb-2">Lawn Size (sq ft)</label>
                                    <input
                                        type="number"
                                        value={profileData.lawnSize}
                                        onChange={(e) => setProfileData({...profileData, lawnSize: e.target.value})}
                                        placeholder="5000"
                                        className="w-full px-4 py-3 border-2 rounded-lg"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium mb-2">Climate Zone</label>
                                    <select
                                        value={profileData.zone}
                                        onChange={(e) => setProfileData({...profileData, zone: e.target.value})}
                                        className="w-full px-4 py-3 border-2 rounded-lg"
                                    >
                                        <option value="">Select...</option>
                                        <option value="4">Zone 4 - Northern Cold</option>
                                        <option value="5">Zone 5 - Northern</option>
                                        <option value="6">Zone 6 - Moderate</option>
                                        <option value="7">Zone 7 - Transition Zone</option>
                                        <option value="8">Zone 8 - Southern</option>
                                        <option value="9">Zone 9 - Deep South / Gulf</option>
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium mb-2">Grass Type</label>
                                    <select
                                        value={profileData.specificGrass}
                                        onChange={(e) => setProfileData({...profileData, specificGrass: e.target.value})}
                                        className="w-full px-4 py-3 border-2 rounded-lg"
                                    >
                                        <option value="">Select...</option>
                                        <optgroup label="Cool Season">
                                            <option value="tall-fescue">Tall Fescue</option>
                                            <option value="kentucky-bluegrass">Kentucky Bluegrass</option>
                                            <option value="perennial-ryegrass">Perennial Ryegrass</option>
                                        </optgroup>
                                        <optgroup label="Warm Season">
                                            <option value="bermuda">Bermudagrass</option>
                                            <option value="zoysia">Zoysia</option>
                                            <option value="st-augustine">St. Augustine</option>
                                        </optgroup>
                                    </select>
                                </div>
                                <button onClick={save} className="w-full py-4 bg-[#367C2B] text-white rounded-xl font-bold text-lg">
                                    üíæ Save Profile
                                </button>
                            </div>
                        </div>
                    );
                }

                // Overview display (shown after save)
                return (
                    <div className="space-y-4">
                        <div className="flex items-center justify-between mb-2">
                            <h2 className="text-2xl font-bold">üå± My Yard</h2>
                            <button onClick={() => setEditing(true)} className="px-4 py-2 text-sm font-semibold text-[#367C2B] border-2 border-[#367C2B] rounded-lg hover:bg-[#367C2B]/10">
                                Edit Profile
                            </button>
                        </div>

                        {/* Lawn summary header */}
                        <div className="bg-gradient-to-r from-[#367C2B] to-[#4a9c3a] rounded-xl p-5 text-white shadow-lg">
                            <div className="text-lg font-bold">{grassInfo ? grassInfo.name : profileData.specificGrass}</div>
                            <div className="text-sm opacity-90 mt-1">
                                {grassInfo && <span>{grassInfo.season}</span>}
                                {zoneInfo && <span> ¬∑ Zone {profileData.zone} ({zoneInfo.climate})
                                    <CitationBadge sources={[{ name: 'USDA Plant Hardiness Zone Map', url: 'https://planthardiness.ars.usda.gov/', topic: 'Official zone classifications' }]} label="USDA Zone" />
                                </span>}
                                {profileData.lawnSize && <span> ¬∑ {Number(profileData.lawnSize).toLocaleString()} sq ft</span>}
                            </div>
                            {grassInfo && (
                                <div className="mt-3 text-sm opacity-90 italic">"{grassInfo.bestFeature}"</div>
                            )}
                        </div>

                        {/* Zone compatibility note */}
                        {grassInfo && grassInfo.zoneNotes && grassInfo.zoneNotes[profileData.zone] && (
                            <div className={`rounded-xl p-4 border-l-4 ${
                                grassInfo.zoneNotes[profileData.zone].toLowerCase().includes('not recommended') ||
                                grassInfo.zoneNotes[profileData.zone].toLowerCase().includes('not viable')
                                    ? 'bg-red-50 border-red-500'
                                    : grassInfo.zoneNotes[profileData.zone].toLowerCase().includes('challenging') ||
                                      grassInfo.zoneNotes[profileData.zone].toLowerCase().includes('difficult') ||
                                      grassInfo.zoneNotes[profileData.zone].toLowerCase().includes('marginal')
                                        ? 'bg-yellow-50 border-yellow-500'
                                        : 'bg-[#e8f5e9] border-[#367C2B]'
                            }`}>
                                <div className="font-bold text-sm mb-1">Zone {profileData.zone} Compatibility <CitationBadge sources={grassInfo.sources} label="Zone adaptation" /></div>
                                <div className="text-sm text-gray-700">{grassInfo.zoneNotes[profileData.zone]}</div>
                            </div>
                        )}

                        {/* Quick reference stats */}
                        {grassInfo && (
                            <div className="bg-white rounded-xl shadow-lg p-4">
                                <h3 className="text-sm font-bold text-[#367C2B] uppercase mb-3">Quick Reference <CitationBadge sources={grassInfo.sources} label="Grass care specs" /></h3>
                                <div className="grid grid-cols-2 gap-3">
                                    <div className="bg-gray-50 rounded-lg p-3 text-center">
                                        <div className="text-xs text-gray-500 mb-1">Mow Height</div>
                                        <div className="text-sm font-bold text-gray-800">{grassInfo.mowHeight}</div>
                                        <div className="text-xs text-gray-400 mt-1">Summer: {grassInfo.mowHeightSummer}</div>
                                    </div>
                                    <div className="bg-gray-50 rounded-lg p-3 text-center">
                                        <div className="text-xs text-gray-500 mb-1">Water / Week</div>
                                        <div className="text-sm font-bold text-gray-800">{grassInfo.waterPerWeek}</div>
                                    </div>
                                    <div className="bg-gray-50 rounded-lg p-3 text-center">
                                        <div className="text-xs text-gray-500 mb-1">Sun Needs</div>
                                        <div className="text-sm font-bold text-gray-800">{grassInfo.sunNeeds}</div>
                                    </div>
                                    <div className="bg-gray-50 rounded-lg p-3 text-center">
                                        <div className="text-xs text-gray-500 mb-1">Fertilizer / Year</div>
                                        <div className="text-sm font-bold text-gray-800">{grassInfo.fertPerYear}</div>
                                    </div>
                                    <div className="bg-gray-50 rounded-lg p-3 text-center">
                                        <div className="text-xs text-gray-500 mb-1">Ideal Soil pH</div>
                                        <div className="text-sm font-bold text-gray-800">{grassInfo.idealSoilPH}</div>
                                    </div>
                                    <div className="bg-gray-50 rounded-lg p-3 text-center">
                                        <div className="text-xs text-gray-500 mb-1">Peak Growth</div>
                                        <div className="text-sm font-bold text-gray-800">{grassInfo.peakGrowth}</div>
                                    </div>
                                    {grassInfo.idealSoilTemp && (
                                        <div className="bg-gray-50 rounded-lg p-3 text-center col-span-2">
                                            <div className="text-xs text-gray-500 mb-1">Ideal Soil Temp</div>
                                            <div className="text-sm font-bold text-gray-800">{grassInfo.idealSoilTemp}</div>
                                        </div>
                                    )}
                                </div>
                                <div className="mt-3 p-3 bg-blue-50 rounded-lg">
                                    <div className="text-xs text-blue-600 font-semibold mb-1">Dormancy</div>
                                    <div className="text-sm text-gray-700">{grassInfo.dormancy}</div>
                                </div>
                            </div>
                        )}

                        {/* Current month tasks from grassPrograms */}
                        {currentTasks && (
                            <div className="bg-white rounded-xl shadow-lg p-4">
                                <h3 className="text-sm font-bold text-[#367C2B] uppercase mb-1">This Month's Tasks <CitationBadge sources={grassInfo ? grassInfo.sources : null} label="Monthly program" /></h3>
                                <div className="text-xs text-gray-500 mb-3">{currentTasks.month}{currentTasks.importance ? ` - ${currentTasks.importance}` : ''}</div>
                                <ul className="space-y-2">
                                    {currentTasks.tasks.map((task, i) => (
                                        <li key={i} className="flex items-start gap-2 text-sm text-gray-700">
                                            <span className="text-[#367C2B] mt-0.5 font-bold">¬∑</span>
                                            <span>{task}</span>
                                        </li>
                                    ))}
                                </ul>
                                {currentTasks.soilTemp && (
                                    <div className="mt-3 text-xs text-gray-500">Target soil temp: {currentTasks.soilTemp}</div>
                                )}
                            </div>
                        )}

                        {/* Full annual program */}
                        {(() => {
                            if (!profileData.specificGrass || !profileData.zone) return null;
                            const keyMap = {
                                'tall-fescue': 'tallFescue',
                                'kentucky-bluegrass': 'kentuckyBluegrass',
                                'perennial-ryegrass': 'perennialRyegrass',
                                'bermuda': 'bermuda',
                                'zoysia': 'zoysia',
                                'st-augustine': 'stAugustine'
                            };
                            const programKey = keyMap[profileData.specificGrass] + '_zone' + profileData.zone;
                            const program = typeof grassPrograms !== 'undefined' ? grassPrograms[programKey] : null;
                            if (!program || !program.schedule) return null;

                            const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
                            const currentMonth = months[new Date().getMonth()];
                            const [showFullProgram, setShowFullProgram] = React.useState(false);

                            const isCurrentMonth = (monthStr) => {
                                if (monthStr === currentMonth) return true;
                                if (monthStr && monthStr.includes('-')) {
                                    const parts = monthStr.split('-');
                                    const startIdx = months.indexOf(parts[0]);
                                    const endIdx = months.indexOf(parts[1]);
                                    const curIdx = months.indexOf(currentMonth);
                                    if (startIdx >= 0 && endIdx >= 0 && curIdx >= startIdx && curIdx <= endIdx) return true;
                                }
                                return false;
                            };

                            return (
                                <div className="bg-white rounded-xl shadow-lg p-4">
                                    <div className="flex items-center justify-between mb-3">
                                        <h3 className="text-sm font-bold text-[#367C2B] uppercase">Full Year Program <CitationBadge sources={program.sources} label="Annual program" /></h3>
                                        <button
                                            onClick={() => setShowFullProgram(!showFullProgram)}
                                            className="text-xs font-semibold text-[#367C2B] border border-[#367C2B] rounded-lg px-3 py-1 hover:bg-[#367C2B]/10"
                                        >
                                            {showFullProgram ? 'Collapse' : 'View All Months'}
                                        </button>
                                    </div>
                                    <div className="text-xs text-gray-500 mb-3">{program.description}</div>
                                    {program.warning && (
                                        <div className="mb-3 p-2 bg-yellow-50 border border-yellow-300 rounded-lg text-xs text-yellow-800">{program.warning}</div>
                                    )}
                                    {showFullProgram && (
                                        <div className="space-y-3">
                                            {program.schedule.map((entry, i) => (
                                                <div key={i} className={`p-3 rounded-lg border-2 ${
                                                    isCurrentMonth(entry.month)
                                                        ? 'border-[#367C2B] bg-[#e8f5e9]'
                                                        : 'border-gray-100 bg-gray-50'
                                                }`}>
                                                    <div className="flex items-center justify-between mb-2">
                                                        <div className="text-sm font-bold text-gray-800">
                                                            {isCurrentMonth(entry.month) && <span className="text-[#367C2B] mr-1">‚ñ∂</span>}
                                                            {entry.month}
                                                        </div>
                                                        {entry.importance && (
                                                            <span className="text-xs font-bold text-white bg-orange-500 px-2 py-0.5 rounded-full">{entry.importance}</span>
                                                        )}
                                                    </div>
                                                    {entry.soilTemp && (
                                                        <div className="text-xs text-gray-500 mb-1">Soil temp: {entry.soilTemp}</div>
                                                    )}
                                                    <ul className="space-y-1">
                                                        {entry.tasks.map((task, j) => (
                                                            <li key={j} className="text-xs text-gray-700 flex items-start gap-1">
                                                                <span className="text-[#367C2B] mt-0.5">¬∑</span>
                                                                <span>{task}</span>
                                                            </li>
                                                        ))}
                                                    </ul>
                                                </div>
                                            ))}
                                            {program.sources && program.sources.length > 0 && (
                                                <div className="text-xs text-gray-400 text-center mt-3 pt-3 border-t border-gray-100">
                                                    Sources: {program.sources.map((s, i) => (
                                                        <span key={i}>
                                                            {i > 0 && ', '}
                                                            {s.url ? (
                                                                <a href={s.url} target="_blank" rel="noopener noreferrer" className="text-[#367C2B] underline hover:text-[#2d6323]">{s.institution}</a>
                                                            ) : s.institution}
                                                        </span>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                    )}
                                    {!showFullProgram && (
                                        <div className="text-xs text-gray-400 text-center">Tap "View All Months" to see the complete {program.schedule.length}-month program</div>
                                    )}
                                </div>
                            );
                        })()}

                        {/* Key tips */}
                        {grassInfo && grassInfo.keyTips && (
                            <div className="bg-white rounded-xl shadow-lg p-4">
                                <h3 className="text-sm font-bold text-[#367C2B] uppercase mb-3">Key Tips for {grassInfo.name} <CitationBadge sources={grassInfo.sources} label="Care tips" /></h3>
                                <ul className="space-y-2">
                                    {grassInfo.keyTips.map((tip, i) => (
                                        <li key={i} className="flex items-start gap-2 text-sm text-gray-700">
                                            <span className="text-[#367C2B] mt-0.5">üí°</span>
                                            <span>{tip}</span>
                                        </li>
                                    ))}
                                </ul>
                            </div>
                        )}

                        {/* Common issues */}
                        {grassInfo && grassInfo.commonIssues && (
                            <div className="bg-white rounded-xl shadow-lg p-4">
                                <h3 className="text-sm font-bold text-orange-600 uppercase mb-3">Watch Out For <CitationBadge sources={grassInfo.sources} label="Common issues" /></h3>
                                <ul className="space-y-2">
                                    {grassInfo.commonIssues.map((issue, i) => (
                                        <li key={i} className="flex items-start gap-2 text-sm text-gray-700">
                                            <span className="text-orange-500 mt-0.5">‚ö†Ô∏è</span>
                                            <span>{issue}</span>
                                        </li>
                                    ))}
                                </ul>
                            </div>
                        )}

                        {/* Research sources with links */}
                        {grassInfo && grassInfo.sources && grassInfo.sources.length > 0 && (
                            <div className="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
                                <div className="text-xs font-bold text-gray-500 uppercase mb-2 flex items-center gap-1">
                                    <span>üìö</span> Research Sources
                                </div>
                                <div className="space-y-1">
                                    {grassInfo.sources.map((s, i) => (
                                        <div key={i} className="flex items-start gap-2 text-xs">
                                            <span className="text-[#367C2B] mt-0.5">¬∑</span>
                                            {s.url ? (
                                                <a href={s.url} target="_blank" rel="noopener noreferrer" className="text-[#367C2B] hover:text-[#2d6323] underline font-semibold">
                                                    {s.name}
                                                </a>
                                            ) : (
                                                <span className="text-gray-600 font-semibold">{s.name}</span>
                                            )}
                                            {s.topic && <span className="text-gray-400">‚Äî {s.topic}</span>}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>
                );
            };

            const Dashboard = () => {
                const [expandedRecentId, setExpandedRecentId] = useState(null);
                const now = new Date();
                const filtered = statsView === 'year'
                    ? activities.filter(a => new Date(a.date).getFullYear() === now.getFullYear())
                    : statsView === 'season'
                    ? activities.filter(a => {
                        const d = new Date(a.date);
                        const diffDays = Math.floor((now - d) / (1000 * 60 * 60 * 24));
                        return diffDays <= 90;
                    })
                    : activities;

                const stats = {
                    total: filtered.length,
                    mowing: filtered.filter(a => a.type === 'mowing').length,
                    fertilizer: filtered.filter(a => a.type === 'fertilizer').length,
                    watering: filtered.filter(a => a.type === 'watering').length
                };

                return (
                    <div className="animate-fade-in">
                        <h2 className="text-2xl font-bold mb-4">üìä Dashboard</h2>

                        <div className="flex gap-2 bg-gray-100 p-1 rounded-lg mb-4">
                            {[
                                { key: 'year', label: 'This Year' },
                                { key: 'season', label: 'Season' },
                                { key: 'all', label: 'All Time' }
                            ].map(({ key, label }) => (
                                <button
                                    key={key}
                                    onClick={() => setStatsView(key)}
                                    className={`flex-1 py-2 px-4 rounded-md text-sm font-semibold transition btn-press ${
                                        statsView === key
                                            ? 'bg-[#367C2B] text-white shadow'
                                            : 'text-gray-600 hover:text-gray-900'
                                    }`}
                                >
                                    {label}
                                </button>
                            ))}
                        </div>

                        <div className="grid grid-cols-4 gap-2 mb-6">
                            <div className="bg-white rounded-xl p-3 shadow-md text-center border-t-2 border-[#367C2B]">
                                <div className="text-2xl font-bold text-[#367C2B]">{stats.total}</div>
                                <div className="text-xs text-gray-500">Total</div>
                            </div>
                            <div className="bg-white rounded-xl p-3 shadow-md text-center border-t-2 border-[#367C2B]">
                                <div className="text-2xl font-bold text-[#367C2B]">{stats.mowing}</div>
                                <div className="text-xs text-gray-500">Mows</div>
                            </div>
                            <div className="bg-white rounded-xl p-3 shadow-md text-center border-t-2 border-[#F97316]">
                                <div className="text-2xl font-bold text-[#F97316]">{stats.fertilizer}</div>
                                <div className="text-xs text-gray-500">Feeds</div>
                            </div>
                            <div className="bg-white rounded-xl p-3 shadow-md text-center border-t-2 border-[#3B82F6]">
                                <div className="text-2xl font-bold text-[#3B82F6]">{stats.watering}</div>
                                <div className="text-xs text-gray-500">Water</div>
                            </div>
                        </div>

                        <div className="bg-white rounded-xl p-4 shadow-md">
                            <h3 className="text-lg font-bold mb-4">Recent Activity</h3>
                            {filtered.slice(-5).reverse().map(activity => {
                                const colors = ACTIVITY_COLORS[activity.type] || ACTIVITY_COLORS.mowing;
                                return (
                                    <div key={activity.id} className={`pb-3 mb-3 border-b last:border-0 cursor-pointer card-hover pl-3 border-l-2 ${colors.border}`} onClick={() => setExpandedRecentId(expandedRecentId === activity.id ? null : activity.id)}>
                                        <div className="flex items-center gap-3">
                                            <div className="text-2xl">{ACTIVITY_TYPES[activity.type].icon}</div>
                                            <div className="flex-1">
                                                <div className={`font-semibold ${colors.text}`}>{ACTIVITY_TYPES[activity.type].name}</div>
                                                <div className="text-sm text-gray-500">{new Date(activity.date).toLocaleDateString()}</div>
                                            </div>
                                            <span className="text-gray-400 text-xs">{expandedRecentId === activity.id ? '‚ñ≤' : '‚ñº'}</span>
                                        </div>
                                        {expandedRecentId === activity.id && <ActivityDetails activity={activity} />}
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                );
            };

            const Settings = () => {
                const exportData = () => {
                    const data = {
                        activities: JSON.parse(localStorage.getItem('lawnCareActivities') || '[]'),
                        equipment: JSON.parse(localStorage.getItem('lawnCareEquipment') || '[]'),
                        profile: JSON.parse(localStorage.getItem('lawnProfile') || 'null')
                    };
                    
                    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `lawn-tracker-backup-${new Date().toISOString().split('T')[0]}.json`;
                    link.click();
                };

                const resetData = () => {
                    if (confirm('‚ö†Ô∏è Delete ALL data? This cannot be undone!')) {
                        localStorage.removeItem('lawnCareActivities');
                        localStorage.removeItem('lawnCareEquipment');
                        localStorage.removeItem('lawnProfile');
                        alert('‚úÖ Data cleared');
                        window.location.reload();
                    }
                };

                return (
                    <div>
                        <h2 className="text-2xl font-bold mb-6">‚öôÔ∏è Settings</h2>

                        <div className="bg-white rounded-xl p-4 shadow mb-4">
                            <h3 className="text-lg font-bold mb-4">üíæ Data Management</h3>
                            <button onClick={exportData} className="w-full py-3 px-4 bg-[#367C2B] text-white rounded-lg font-semibold mb-3">
                                üì• Export Data
                            </button>
                            <button onClick={resetData} className="w-full py-3 px-4 bg-red-100 text-red-700 rounded-lg font-semibold">
                                üóëÔ∏è Reset All Data
                            </button>
                        </div>

                        <div className="bg-white rounded-xl p-4 shadow">
                            <h3 className="text-lg font-bold mb-4">‚ÑπÔ∏è About</h3>
                            <p className="text-sm text-gray-600 font-semibold">Lawn Care Tracker v7.0</p>
                            <p className="text-xs text-gray-500 mt-2">All data stored locally</p>

                            <div className="mt-4 pt-4 border-t border-gray-200">
                                <h4 className="text-sm font-bold text-gray-700 mb-3">Release Notes</h4>
                                <div className="space-y-3">
                                    <div className="border-l-3 border-[#367C2B] pl-3" style={{borderLeft: '3px solid #367C2B'}}>
                                        <div className="text-sm font-bold text-[#367C2B]">v7.0 <span className="text-xs font-normal text-gray-400">Feb 2026</span></div>
                                        <ul className="text-xs text-gray-600 mt-1 space-y-0.5">
                                            <li>+ Branded green gradient header for stronger visual identity</li>
                                            <li>+ Seasonal status banner with soil-temp-aware messaging</li>
                                            <li>+ Merged Home + Dashboard: year stats visible on landing page</li>
                                            <li>+ Activity color coding throughout History, Add, and Dashboard</li>
                                            <li>+ Removed redundant bottom nav bar (hamburger menu is primary nav)</li>
                                            <li>+ Cleaner card styling: lighter shadows, colored left borders</li>
                                            <li>+ Micro-interactions: press feedback, fade-in animations, smooth transitions</li>
                                        </ul>
                                    </div>
                                    <div className="border-l-3 border-gray-300 pl-3" style={{borderLeft: '3px solid #d1d5db'}}>
                                        <div className="text-sm font-bold text-gray-600">v6.1 <span className="text-xs font-normal text-gray-400">Feb 2026</span></div>
                                        <ul className="text-xs text-gray-600 mt-1 space-y-0.5">
                                            <li>+ Product Guide: browse all 96+ products across 5 categories</li>
                                            <li>+ Expandable spec sheets for every mower, spreader, trimmer, fertilizer, and seed</li>
                                            <li>+ Side-by-side comparison tool (select up to 3 products)</li>
                                            <li>+ Filter by category, mower type, and brand</li>
                                            <li>+ Quick link from My Garage to Product Guide</li>
                                        </ul>
                                    </div>
                                    <div className="border-l-3 border-gray-300 pl-3" style={{borderLeft: '3px solid #d1d5db'}}>
                                        <div className="text-sm font-bold text-gray-600">v6.0 <span className="text-xs font-normal text-gray-400">Feb 2026</span></div>
                                        <ul className="text-xs text-gray-600 mt-1 space-y-0.5">
                                            <li>+ Soil temperature display in My Yard quick reference</li>
                                            <li>+ Treatment product detail cards (rate, timing, target, active ingredient)</li>
                                            <li>+ Full annual program calendar in My Yard with month-by-month tasks</li>
                                            <li>+ Equipment maintenance tracker with hour-based service alerts</li>
                                            <li>+ Version release notes in Settings</li>
                                        </ul>
                                    </div>
                                    <div className="border-l-3 border-gray-300 pl-3" style={{borderLeft: '3px solid #d1d5db'}}>
                                        <div className="text-sm font-bold text-gray-600">v5.0 <span className="text-xs font-normal text-gray-400">Feb 2026</span></div>
                                        <ul className="text-xs text-gray-600 mt-1 space-y-0.5">
                                            <li>+ My Yard overview with grass type info and zone compatibility</li>
                                            <li>+ Current month tasks from research-backed programs</li>
                                            <li>+ Mower type filtering and expanded model database</li>
                                            <li>+ Dashboard view toggle (This Year / Season / All Time)</li>
                                        </ul>
                                    </div>
                                    <div className="border-l-3 border-gray-300 pl-3" style={{borderLeft: '3px solid #d1d5db'}}>
                                        <div className="text-sm font-bold text-gray-600">v4.0 <span className="text-xs font-normal text-gray-400">Feb 2026</span></div>
                                        <ul className="text-xs text-gray-600 mt-1 space-y-0.5">
                                            <li>+ Initial release with activity tracking, My Garage, and weather</li>
                                            <li>+ 76+ mower models, treatment products, and research sources</li>
                                            <li>+ Lawn profile setup with 6 grass types across zones 4-9</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            const ProductGuide = () => {
                const [category, setCategory] = useState('mowers');
                const [mowerType, setMowerType] = useState('');
                const [brandFilter, setBrandFilter] = useState('');
                const [compareList, setCompareList] = useState([]);
                const [showCompare, setShowCompare] = useState(false);
                const [expandedId, setExpandedId] = useState(null);

                const allProducts = (PRODUCT_DATABASE[category] || []).filter(p => !p.id.includes('-other'));
                const brands = [...new Set(allProducts.map(p => p.brand))].sort();

                let filtered = allProducts;
                if (category === 'mowers' && mowerType) {
                    filtered = filtered.filter(p => p.mowerCategory === mowerType);
                }
                if (brandFilter) {
                    filtered = filtered.filter(p => p.brand === brandFilter);
                }

                const toggleCompare = (product) => {
                    if (compareList.find(p => p.id === product.id)) {
                        setCompareList(compareList.filter(p => p.id !== product.id));
                    } else if (compareList.length < 3) {
                        setCompareList([...compareList, product]);
                    }
                };

                const typeLabels = { mowers: 'Mowers', spreaders: 'Spreaders', trimmers: 'Trimmers', fertilizers: 'Fertilizers', seeds: 'Grass Seed' };
                const typeIcons = { mowers: 'üöú', spreaders: 'üì°', trimmers: '‚úÇÔ∏è', fertilizers: 'üåæ', seeds: 'üå±' };

                const renderSpec = (label, value) => {
                    if (!value) return null;
                    return (
                        <div className="flex justify-between text-xs py-1 border-b border-gray-100">
                            <span className="text-gray-500">{label}</span>
                            <span className="font-semibold text-gray-800 text-right">{value}</span>
                        </div>
                    );
                };

                const ProductCard = ({ product }) => {
                    const isExpanded = expandedId === product.id;
                    const isCompared = compareList.find(p => p.id === product.id);
                    return (
                        <div className={`bg-white rounded-xl shadow border-2 transition ${isCompared ? 'border-[#367C2B]' : 'border-gray-100'}`}>
                            <div className="p-3 cursor-pointer" onClick={() => setExpandedId(isExpanded ? null : product.id)}>
                                <div className="flex items-start justify-between">
                                    <div className="flex-1">
                                        <div className="text-sm font-bold text-gray-900">{product.name}</div>
                                        <div className="text-xs text-[#367C2B] font-semibold">{product.brand}</div>
                                        {product.type && <div className="text-xs text-gray-500 mt-0.5">{product.type}</div>}
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <button
                                            onClick={(e) => { e.stopPropagation(); toggleCompare(product); }}
                                            className={`px-3 py-1.5 rounded-full text-xs font-bold transition-all ${
                                                isCompared
                                                    ? 'bg-[#367C2B] text-white shadow-md ring-2 ring-[#367C2B]/30'
                                                    : compareList.length >= 3
                                                        ? 'bg-gray-100 text-gray-400 cursor-not-allowed'
                                                        : 'bg-gray-100 text-gray-700 hover:bg-[#367C2B] hover:text-white hover:shadow'
                                            }`}
                                            disabled={!isCompared && compareList.length >= 3}
                                        >
                                            {isCompared ? '‚úì Selected' : '+ Compare'}
                                        </button>
                                        <span className="text-gray-400 text-xs">{isExpanded ? '‚ñ≤' : '‚ñº'}</span>
                                    </div>
                                </div>
                            </div>
                            {isExpanded && (
                                <div className="px-3 pb-3 border-t border-gray-100 pt-2">
                                    {renderSpec('Brand', product.brand)}
                                    {product.deck && renderSpec('Deck Size', product.deck)}
                                    {product.type && renderSpec('Type', product.type)}
                                    {product.mowerCategory && renderSpec('Category', product.mowerCategory)}
                                    {product.features && renderSpec('Features', product.features)}
                                    {product.engineType && renderSpec('Engine', product.engineType)}
                                    {product.lineSize && renderSpec('Line Size', product.lineSize)}
                                    {product.capacity && renderSpec('Capacity', product.capacity)}
                                    {product.npk && renderSpec('NPK', product.npk)}
                                    {product.coverage && renderSpec('Coverage', product.coverage)}
                                    {product.variety && renderSpec('Variety', product.variety)}
                                    {product.maintenanceSchedule && (
                                        <div className="mt-2 p-2 bg-gray-50 rounded-lg">
                                            <div className="text-xs font-bold text-gray-600 mb-1">Maintenance</div>
                                            {product.maintenanceSchedule.note ? (
                                                <div className="text-xs text-gray-500 italic">{product.maintenanceSchedule.note}</div>
                                            ) : (
                                                <div className="text-xs text-gray-600 space-y-0.5">
                                                    {product.maintenanceSchedule.oilChange && <div>Oil change: every {product.maintenanceSchedule.oilChange} hrs</div>}
                                                    {product.maintenanceSchedule.airFilter && <div>Air filter: {typeof product.maintenanceSchedule.airFilter === 'number' ? `every ${product.maintenanceSchedule.airFilter} hrs` : product.maintenanceSchedule.airFilter}</div>}
                                                    {product.maintenanceSchedule.sparkPlug && <div>Spark plug: {typeof product.maintenanceSchedule.sparkPlug === 'number' ? `every ${product.maintenanceSchedule.sparkPlug} hrs` : product.maintenanceSchedule.sparkPlug}</div>}
                                                    {product.maintenanceSchedule.cleaning && <div>Cleaning: {product.maintenanceSchedule.cleaning}</div>}
                                                    {product.maintenanceSchedule.lubrication && <div>Lubrication: {product.maintenanceSchedule.lubrication}</div>}
                                                </div>
                                            )}
                                        </div>
                                    )}
                                </div>
                            )}
                        </div>
                    );
                };

                // Comparison view
                if (showCompare && compareList.length >= 2) {
                    const specRows = [
                        { label: 'Brand', key: 'brand' },
                        { label: 'Type', key: 'type' },
                        { label: 'Deck Size', key: 'deck', show: category === 'mowers' },
                        { label: 'Category', key: 'mowerCategory', show: category === 'mowers' },
                        { label: 'Features', key: 'features' },
                        { label: 'Engine', key: 'engineType', show: category === 'trimmers' },
                        { label: 'Line Size', key: 'lineSize', show: category === 'trimmers' },
                        { label: 'Capacity', key: 'capacity', show: category === 'spreaders' },
                        { label: 'NPK', key: 'npk', show: category === 'fertilizers' },
                        { label: 'Coverage', key: 'coverage', show: ['fertilizers', 'seeds'].includes(category) },
                        { label: 'Variety', key: 'variety', show: category === 'seeds' },
                        { label: 'Oil Change', fn: (p) => p.maintenanceSchedule?.oilChange ? `Every ${p.maintenanceSchedule.oilChange} hrs` : p.maintenanceSchedule?.note || '-' },
                        { label: 'Air Filter', fn: (p) => p.maintenanceSchedule?.airFilter ? (typeof p.maintenanceSchedule.airFilter === 'number' ? `Every ${p.maintenanceSchedule.airFilter} hrs` : p.maintenanceSchedule.airFilter) : '-' },
                        { label: 'Spark Plug', fn: (p) => p.maintenanceSchedule?.sparkPlug ? (typeof p.maintenanceSchedule.sparkPlug === 'number' ? `Every ${p.maintenanceSchedule.sparkPlug} hrs` : p.maintenanceSchedule.sparkPlug) : '-' }
                    ].filter(r => r.show === undefined || r.show);

                    return (
                        <div>
                            <div className="flex items-center justify-between mb-4">
                                <h2 className="text-xl font-bold">Side-by-Side Comparison</h2>
                                <button onClick={() => setShowCompare(false)} className="px-3 py-1 text-sm font-semibold text-[#367C2B] border border-[#367C2B] rounded-lg hover:bg-[#367C2B]/10">
                                    Back to Browse
                                </button>
                            </div>

                            <div className="overflow-x-auto -mx-2 px-2 pb-2">
                                <div className="bg-white rounded-xl shadow-lg overflow-hidden" style={{minWidth: `${120 + compareList.length * 150}px`}}>
                                    {/* Product names header */}
                                    <div className="grid gap-0 border-b-2 border-[#367C2B]" style={{gridTemplateColumns: `120px repeat(${compareList.length}, 1fr)`}}>
                                        <div className="p-3 bg-gray-50 font-bold text-xs text-gray-500 uppercase">Spec</div>
                                        {compareList.map(p => (
                                            <div key={p.id} className="p-3 bg-[#367C2B]/5 text-center">
                                                <div className="text-sm font-bold text-gray-900">{p.name}</div>
                                                <div className="text-xs text-[#367C2B]">{p.brand}</div>
                                                <button onClick={() => toggleCompare(p)} className="mt-1 text-xs text-red-500 hover:text-red-700">Remove</button>
                                            </div>
                                        ))}
                                    </div>

                                    {/* Spec rows */}
                                    {specRows.map((row, i) => {
                                        const values = compareList.map(p => row.fn ? row.fn(p) : (p[row.key] || '-'));
                                        if (values.every(v => v === '-' || !v)) return null;
                                        const allSame = values.every(v => v === values[0]);
                                        return (
                                            <div key={row.label} className={`grid gap-0 ${i % 2 === 0 ? 'bg-white' : 'bg-gray-50'} border-b border-gray-100`} style={{gridTemplateColumns: `120px repeat(${compareList.length}, 1fr)`}}>
                                                <div className="p-2 text-xs font-semibold text-gray-600">{row.label}</div>
                                                {values.map((val, j) => (
                                                    <div key={j} className={`p-2 text-xs text-center ${!allSame && val !== '-' ? 'font-bold text-[#367C2B]' : 'text-gray-700'}`}>
                                                        {val}
                                                    </div>
                                                ))}
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        </div>
                    );
                }

                return (
                    <div>
                        <h2 className="text-xl font-bold mb-4">üìñ Product Guide</h2>

                        {/* Category tabs */}
                        <div className="flex gap-1 bg-gray-100 p-1 rounded-lg mb-4 overflow-x-auto">
                            {Object.entries(typeLabels).map(([key, label]) => (
                                <button
                                    key={key}
                                    onClick={() => { setCategory(key); setMowerType(''); setBrandFilter(''); setCompareList([]); setExpandedId(null); }}
                                    className={`flex-shrink-0 py-2 px-3 rounded-md text-xs font-semibold transition ${
                                        category === key ? 'bg-[#367C2B] text-white shadow' : 'text-gray-600 hover:text-gray-900'
                                    }`}
                                >
                                    {typeIcons[key]} {label}
                                </button>
                            ))}
                        </div>

                        {/* Filters */}
                        <div className="bg-white rounded-xl shadow p-3 mb-4">
                            <div className="flex items-center gap-2 flex-wrap">
                                {category === 'mowers' && (
                                    <div className="flex gap-1">
                                        {['', 'Walk Behind', 'Riding', 'Zero Turn'].map(mt => (
                                            <button
                                                key={mt}
                                                onClick={() => { setMowerType(mt); setExpandedId(null); }}
                                                className={`px-2 py-1 rounded text-xs font-semibold ${
                                                    mowerType === mt ? 'bg-[#367C2B] text-white' : 'bg-gray-100 text-gray-600'
                                                }`}
                                            >
                                                {mt || 'All'}
                                            </button>
                                        ))}
                                    </div>
                                )}
                                <select
                                    value={brandFilter}
                                    onChange={(e) => { setBrandFilter(e.target.value); setExpandedId(null); }}
                                    className="px-2 py-1 border rounded text-xs"
                                >
                                    <option value="">All Brands ({brands.length})</option>
                                    {brands.map(b => <option key={b} value={b}>{b}</option>)}
                                </select>
                                <span className="text-xs text-gray-400 ml-auto">{filtered.length} products</span>
                            </div>
                        </div>

                        {/* Sticky compare bar */}
                        {compareList.length > 0 && (
                            <div
                                className="fixed bottom-0 left-0 right-0 z-50 bg-white border-t-2 border-[#367C2B] shadow-2xl"
                                style={{animation: 'slideUpBounce 0.35s cubic-bezier(0.34, 1.56, 0.64, 1)'}}
                            >
                                <div className="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between gap-3">
                                    <div className="flex-1 min-w-0">
                                        <div className="text-xs text-gray-500 font-semibold">{compareList.length}/3 selected</div>
                                        <div className="text-sm font-bold text-gray-800 truncate">{compareList.map(p => p.name).join(' vs ')}</div>
                                    </div>
                                    <div className="flex items-center gap-2 flex-shrink-0">
                                        <button onClick={() => setCompareList([])} className="px-3 py-2 text-xs font-semibold text-gray-500 hover:text-gray-700 border border-gray-300 rounded-lg">
                                            Clear
                                        </button>
                                        {compareList.length >= 2 && (
                                            <button
                                                onClick={() => setShowCompare(true)}
                                                className="px-5 py-2.5 bg-[#FFDE00] text-[#367C2B] rounded-lg text-sm font-extrabold shadow-lg hover:shadow-xl transition-all hover:scale-105"
                                                style={{animation: 'pulseGlow 2s ease-in-out infinite'}}
                                            >
                                                Compare Now ‚Üí
                                            </button>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Product list */}
                        <div className={`space-y-2 ${compareList.length > 0 ? 'pb-20' : ''}`}>
                            {filtered.map(product => (
                                <ProductCard key={product.id} product={product} />
                            ))}
                        </div>

                        {filtered.length === 0 && (
                            <div className="bg-white rounded-xl shadow p-8 text-center text-gray-500">
                                No products match the current filters
                            </div>
                        )}
                    </div>
                );
            };

            const ResearchSourcesPage = () => (
                <div>
                    <h2 className="text-2xl font-bold mb-6">üìö Research Sources</h2>
                    
                    <div className="bg-blue-50 border-2 border-blue-200 rounded-xl p-4 mb-6">
                        <p className="text-sm text-blue-900">
                            <strong>Evidence-Based Recommendations:</strong> All lawn care guidance is based on peer-reviewed research from {RESEARCH_SOURCES.length} university extension programs. These are the same sources professional turf managers use.
                        </p>
                    </div>

                    <div className="bg-white rounded-xl p-4 shadow mb-4">
                        <h3 className="font-bold text-lg mb-2">Total Research Coverage</h3>
                        <div className="grid grid-cols-2 gap-3">
                            <div className="text-center p-3 bg-gray-50 rounded">
                                <div className="text-3xl font-bold text-[#367C2B]">{RESEARCH_SOURCES.length}</div>
                                <div className="text-sm text-gray-600">Universities</div>
                            </div>
                            <div className="text-center p-3 bg-gray-50 rounded">
                                <div className="text-3xl font-bold text-[#367C2B]">
                                    {RESEARCH_SOURCES.reduce((sum, s) => sum + s.count, 0)}
                                </div>
                                <div className="text-sm text-gray-600">Publications</div>
                            </div>
                        </div>
                    </div>

                    <div className="space-y-4">
                        {RESEARCH_SOURCES.map(source => (
                            <div key={source.id} className="bg-white rounded-xl p-4 shadow-md border-l-4 border-[#367C2B]">
                                <div className="flex items-start justify-between mb-2">
                                    <div className="flex-1">
                                        <h3 className="text-lg font-bold text-gray-900">{source.name}</h3>
                                        <p className="text-sm text-gray-600 mt-1">
                                            {source.count} {source.count === 1 ? 'publication' : 'publications'} referenced
                                        </p>
                                    </div>
                                    <div className="text-3xl">üéì</div>
                                </div>
                                
                                {source.topics && (
                                    <div className="mt-2 p-2 bg-gray-50 rounded border-l-2 border-[#367C2B]">
                                        <div className="text-xs font-semibold text-gray-600 mb-1">Topics Covered:</div>
                                        <div className="text-xs text-gray-700">{source.topics}</div>
                                    </div>
                                )}
                                
                                {source.url && (
                                    <a 
                                        href={source.url} 
                                        target="_blank" 
                                        rel="noopener noreferrer"
                                        className="text-[#367C2B] hover:text-[#2d6323] font-semibold text-sm underline mt-3 inline-block"
                                    >
                                        Visit Extension Website ‚Üí
                                    </a>
                                )}
                            </div>
                        ))}
                    </div>

                    <div className="mt-6 p-4 bg-green-50 rounded-lg border-2 border-green-200">
                        <p className="text-sm text-green-900">
                            <strong>Why University Extensions?</strong> Land-grant university extension programs conduct rigorous field research specific to regional climates and grass types. Unlike generic online advice, extension recommendations are tested, peer-reviewed, and updated based on ongoing research.
                        </p>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen bg-gray-50">
                    <header className="sticky top-0 z-50" style={{background: 'linear-gradient(135deg, #367C2B 0%, #4a9c3a 100%)'}}>
                        <div className="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
                            <button onClick={() => { setView(null); setSelectedActivityType(null); }} className="flex items-center btn-press">
                                <div className="text-2xl font-bold text-white">üå± Lawn Care Tracker</div>
                            </button>

                            <button onClick={() => setView(view === 'menu' ? null : 'menu')} className="p-2 rounded-lg hover:bg-white/20 btn-press transition">
                                <svg className="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
                                </svg>
                            </button>
                        </div>

                        {view === 'menu' && (
                            <div className="border-t border-white/20 bg-white shadow-lg menu-slide">
                                <div className="max-w-5xl mx-auto px-4 py-2">
                                    <button onClick={() => { setView('add'); setSelectedActivityType(null); }} className="w-full text-left px-4 py-3 rounded-lg nav-item hover:bg-[#367C2B]/10 flex items-center gap-3">
                                        <span className="text-2xl">‚ûï</span>
                                        <span className="text-lg font-semibold">Add Activity</span>
                                    </button>
                                    <button onClick={() => setView('history')} className="w-full text-left px-4 py-3 rounded-lg nav-item hover:bg-[#367C2B]/10 flex items-center gap-3">
                                        <span className="text-2xl">üìã</span>
                                        <span className="text-lg font-semibold">History</span>
                                    </button>
                                    <button onClick={() => setView('garage')} className="w-full text-left px-4 py-3 rounded-lg nav-item hover:bg-[#367C2B]/10 flex items-center gap-3">
                                        <span className="text-2xl">üè†</span>
                                        <span className="text-lg font-semibold">My Garage</span>
                                    </button>
                                    <button onClick={() => setView('profile')} className="w-full text-left px-4 py-3 rounded-lg nav-item hover:bg-[#367C2B]/10 flex items-center gap-3">
                                        <span className="text-2xl">üå±</span>
                                        <span className="text-lg font-semibold">My Yard</span>
                                    </button>
                                    <button onClick={() => setView('products')} className="w-full text-left px-4 py-3 rounded-lg nav-item hover:bg-[#367C2B]/10 flex items-center gap-3">
                                        <span className="text-2xl">üìñ</span>
                                        <span className="text-lg font-semibold">Product Guide</span>
                                    </button>
                                    <button onClick={() => setView('sources')} className="w-full text-left px-4 py-3 rounded-lg nav-item hover:bg-[#367C2B]/10 flex items-center gap-3">
                                        <span className="text-2xl">üìö</span>
                                        <span className="text-lg font-semibold">Research Sources</span>
                                    </button>
                                    <button onClick={() => setView('settings')} className="w-full text-left px-4 py-3 rounded-lg nav-item hover:bg-[#367C2B]/10 flex items-center gap-3">
                                        <span className="text-2xl">‚öôÔ∏è</span>
                                        <span className="text-lg font-semibold">Settings</span>
                                    </button>
                                </div>
                            </div>
                        )}
                    </header>

                    <SeasonBanner />

                    <div className="max-w-5xl mx-auto p-2 md:p-3">
                        {!view && (
                            <div>
                                <WeatherSnapshot />
                            </div>
                        )}
                        {view === 'add' && (
                            <div>
                                <button onClick={() => { setView(null); setSelectedActivityType(null); }} className="text-[#367C2B] mb-4 btn-press font-semibold">‚Üê Back</button>
                                {!selectedActivityType && <ActivitySelector />}
                                {selectedActivityType && <ActivityForm />}
                            </div>
                        )}
                        {view === 'history' && (
                            <div>
                                <button onClick={() => setView(null)} className="text-[#367C2B] mb-4 btn-press font-semibold">‚Üê Back</button>
                                <HistoryView />
                            </div>
                        )}
                        {view === 'garage' && (
                            <div>
                                <button onClick={() => setView(null)} className="text-[#367C2B] mb-4 btn-press font-semibold">‚Üê Back</button>
                                <MyGarage />
                            </div>
                        )}
                        {view === 'profile' && (
                            <div>
                                <button onClick={() => setView(null)} className="text-[#367C2B] mb-4 btn-press font-semibold">‚Üê Back</button>
                                <LawnProfile />
                            </div>
                        )}
                        {view === 'dashboard' && (
                            <div>
                                <button onClick={() => setView(null)} className="text-[#367C2B] mb-4 btn-press font-semibold">‚Üê Back</button>
                                <Dashboard />
                            </div>
                        )}
                        {view === 'products' && (
                            <div>
                                <button onClick={() => setView(null)} className="text-[#367C2B] mb-4 btn-press font-semibold">‚Üê Back</button>
                                <ProductGuide />
                            </div>
                        )}
                        {view === 'sources' && (
                            <div>
                                <button onClick={() => setView(null)} className="text-[#367C2B] mb-4 btn-press font-semibold">‚Üê Back</button>
                                <ResearchSourcesPage />
                            </div>
                        )}
                        {view === 'settings' && (
                            <div>
                                <button onClick={() => setView(null)} className="text-[#367C2B] mb-4 btn-press font-semibold">‚Üê Back</button>
                                <Settings />
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<LawnCareTracker />);
    </script>
</body>
</html>
